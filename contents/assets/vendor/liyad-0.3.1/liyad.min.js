!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.liyad=t():e.liyad=t()}(this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return f}));var n=r(4),o=r(5);function a(e){if(e.evalCount++,e.config.maxEvalCount&&e.config.maxEvalCount<e.evalCount)throw new n.b}function s(e,t,r,n){if(t.length<r)throw new Error(`[SX] ${e}: Invalid argument length: expected: ${r} / args: ${t.length}.`);if(n&&n<t.length)throw new Error(`[SX] ${e}: Invalid argument length: expected: ${n} / args: ${t.length}.`);return t}const c={}.constructor,i=Function;function l(e,t){if("__proto__"===t||"__defineGetter__"===t||"__defineSetter__"===t||"__lookupGetter__"===t||"__lookupSetter__"===t)throw new Error(`[SX] ${e}: Invalid var name ${t}.`);if("prototype"===t||"constructor"===t)throw new Error(`[SX] ${e}: Invalid var name ${t}.`);if(c.hasOwnProperty(t))throw new Error(`[SX] ${e}: Invalid var name ${t}.`);if("call"===t||"arguments"===t||"caller"===t)throw new Error(`[SX] ${e}: Invalid var name ${t}.`);return t}function f(e,t,r){if(t===o.a||"__proto__"===r||"__defineGetter__"===r||"__defineSetter__"===r||"__lookupGetter__"===r||"__lookupSetter__"===r)throw new Error(`[SX] ${e}: Invalid var name ${r}.`);if(!("prototype"!==r&&"constructor"!==r||null!=t&&"function"!=typeof t))throw new Error(`[SX] ${e}: Invalid var name ${r}.`);if((null==t||t===c)&&c.hasOwnProperty(r))throw new Error(`[SX] ${e}: Invalid var name ${r}.`);if(null==t||t===i){let t=i;for(;t;){if(t.hasOwnProperty(r))throw new Error(`[SX] ${e}: Invalid var name ${r}.`);t=t.__proto__}}if("function"==typeof t&&!t.hasOwnProperty(r))throw new Error(`[SX] ${e}: Invalid var name ${r}.`);return r}},function(e,t,r){"use strict";r.d(t,"l",(function(){return a})),r.d(t,"i",(function(){return s})),r.d(t,"h",(function(){return c})),r.d(t,"k",(function(){return i})),r.d(t,"j",(function(){return l})),r.d(t,"a",(function(){return f})),r.d(t,"c",(function(){return u})),r.d(t,"f",(function(){return m})),r.d(t,"m",(function(){return b})),r.d(t,"e",(function(){return $})),r.d(t,"d",(function(){return p})),r.d(t,"g",(function(){return d})),r.d(t,"b",(function(){return y}));var n=r(2),o=r(0);function a(e){switch(typeof e){case"object":case"symbol":case"function":return NaN;default:return Number(e)}}function s(e,t){if(e.config.enableSplice)for(let r=t.length-1;r>=0;r--){Array.isArray(t[r])&&Object(n.d)(t[r][0],e.config.reservedNames.splice)&&(t=t.slice(0,r).concat(t[r][1],t.slice(r+1)))}return t}function c(e,t,r){const n=e.macroMap.get(t.symbol);let o=null;if(n){let a=n;const s=r.slice(1);for(;a;){if(!a.formalArgs)return{fn:a.fn(e,t.symbol),actualArgs:r};{const n=_(e,t.symbol,a.formalArgs,Boolean(a.lastIsSpread),s);if(!n.error)return{fn:a.fn(e,t.symbol,n.formalArgs),actualArgs:r.slice(0,1).concat(n.actualArgs)};o=n.error,a=a.next}}if(o)throw new Error(o)}return!1}function i(e,t,r){for(let r=e.scopes.length-1;r>0;r--){const n=e.scopes[r];if(n&&Object.prototype.hasOwnProperty.call(n.scope,t.symbol))return n.scope;if(n.capturedScopes&&Object.prototype.hasOwnProperty.call(n.capturedScopes,t.symbol))return n.capturedScopes[t.symbol];if(!n.isBlockLocal)break}const n=p(e);return Object.prototype.hasOwnProperty.call(n.scope,t.symbol)?n.scope:r?null:$(e).scope}function l(e,t){const r=i(e,t,!0);if(r)return r[t.symbol];const n=e.symbolMap.get(t.symbol);if(n)return n.fn(e,t.symbol);if(e.config.valueSymbolResolverFallback)return e.config.valueSymbolResolverFallback(e,t.symbol);if(e.config.raiseOnUnresolvedSymbol)throw new Error(`[SX] resolveValueSymbol: Unresolved symbol: ${t.symbol}.`);return t.symbol}function f(e,t){const r={};for(const n of t){const t=i(e,n,!0);if(null===t)throw new Error(`[SX] collectCapturedVariables: Unresolved symbols ${n}`);Object(o.c)("collectCapturedVariables",r,n.symbol),r[n.symbol]=t}return r}function u(e){const t=[];for(let r=e.scopes.length-1;r>0;r--){const n=e.scopes[r];if(n.capturedScopes&&t.unshift(n.capturedScopes),!n.isBlockLocal)break}return t.length>0?Object.assign({},...t):void 0}function m(e,t,r,n){e.scopes.push({isBlockLocal:r,scope:t,capturedScopes:n})}function b(e){if(e.scopes.length<2)throw new Error("[SX] uninstallScope: Unable to pop stack.");return e.scopes.pop()}function $(e){return e.scopes[e.scopes.length-1]}function p(e){return e.scopes[0]}function _(e,t,r,o,a){if(r=r.slice(0),(a=a.slice(0)).length+(o?1:0)<r.length)return{error:`[SX] macro call (${t}): Actual args too short: actual ${a.length} / formal ${r.length}.`};for(let e=r.length-(o?2:1);e>=0;e--){let o=r[e].symbol;if(o.startsWith("!")){if(r[e].symbol=r[e].symbol.slice(1),o=r[e].symbol,!Object(n.d)(a[e]))return{error:`[SX] macro call (${t}): Actual arg(${e}: ${o}) is not symbol.`}}else if(o.startsWith("<")&&o.endsWith(">")){if(r[e].symbol=r[e].symbol.slice(1,-1),o=r[e].symbol,!Object(n.d)(a[e],o))return{error:`[SX] macro call (${t}): Actual arg(${e}: ${o}) is not expected symbol.`};r=r.slice(0,e).concat(r.slice(e+1)),a=a.slice(0,e).concat(a.slice(e+1))}else{const s=o.lastIndexOf(":");if(0<s){const c=o.slice(s+1);switch(c){case"number":if("number"!=typeof a[e])return{error:`[SX] macro call (${t}): Actual arg(${e}: ${o}) is not number.`};break;case"string":if("string"!=typeof a[e])return{error:`[SX] macro call (${t}): Actual arg(${e}: ${o}) is not string.`};break;case"function":if(!Array.isArray(a[e])||!Object(n.d)(a[e][0]))return{error:`[SX] macro call (${t}): Actual arg(${e}: ${o}) is not function.`};break;case"list":if(!Array.isArray(a[e]))return{error:`[SX] macro call (${t}): Actual arg(${e}: ${o}) is not list.`};break;case"symbol":if(!Object(n.d)(a[e]))return{error:`[SX] macro call (${t}): Actual arg(${e}: ${o}) is not symbol.`};break;case"any":break;default:return{error:`[SX] macro call (${t}): Formal arg(${e}: ${o}) is unknown type ${c}.`}}r[e].symbol=r[e].symbol.slice(0,s)}}}return{formalArgs:r,actualArgs:a}}function d(e,t,r){if(Array.isArray(r[r.length-1])){const n=r.slice(0,r.length-1),o=r[r.length-1];if(o&&"object"==typeof o[0]&&o[0].symbol===e.config.reservedNames.if&&Array.isArray(o[3])&&"object"==typeof o[3][0]&&o[3][0].symbol===e.config.reservedNames.self){const r=`$__tempvar__$$ec${e.evalCount++}$$_`,a=t.map((e,t)=>({symbol:`${r}_$i${t}_${e.symbol}`}));return[[{symbol:e.config.reservedNames.until},o[1],[{symbol:e.config.reservedNames.let},[...a],...n,...o[3].slice(1).map((t,r)=>[{symbol:e.config.reservedNames.set},a[r],t]),...a.map((r,n)=>[{symbol:e.config.reservedNames.set},t[n],r])]],...n,o[2]]}}return r}function y(e,t){if(Object(o.d)(e),null==t)return t;let r=t;for(;Array.isArray(r);){{if(0===r.length)return r;r=s(e,r);const t=Object(n.d)(r[0]);if(!t)break;{const n=c(e,t,r);if(!n)break;r=n.fn(n.actualArgs)}}Object(o.d)(e)}if(Array.isArray(r)){if(0<(r=r.slice(0)).length){const t=Object(n.d)(r[0]);if(t){if(t.symbol===e.config.reservedNames.quote)return r.slice(1,2)[0];if(t.symbol===e.config.reservedNames.backquote)return r=r.slice(1,2)[0],Array.isArray(r)&&(r=function e(t,r){for(let o=0;o<r.length;o++){Array.isArray(r[o])&&Object(n.d)(r[o][0],t.config.reservedNames.unquote)&&(r=r.slice(0,o).concat([y(t,r[o][1])],r.slice(o+1))),Array.isArray(r[o])&&((r=r.slice(0))[o]=e(t,r[o]))}return s(t,r)}(e,r)),r;if(t.symbol===e.config.reservedNames.eval)return y(e,y(e,r.slice(1,2)[0]))}const o=[];for(let t=1;t<r.length;t++){if(Array.isArray(r[t])&&Object(n.d)(r[t][0],e.config.reservedNames.spread)){o.push(t);const n=y(e,r[t][1]);r[t]=Array.isArray(n)?n:[n]}else r[t]=y(e,r[t])}for(const e of o.reverse())r=r.slice(0,e).concat(r[e],r.slice(e+1));let a;if("function"!=typeof(a="function"==typeof r[0]?r[0]:t?function(e,t){if("function"==typeof t)return t;const r=e.funcMap.get(t.symbol);if(r)return r.fn(e,t.symbol);{const r=l(e,t);if("function"==typeof r)return r;if(e.config.funcSymbolResolverFallback)return e.config.funcSymbolResolverFallback(e,t.symbol);if(e.config.raiseOnUnresolvedSymbol)throw new Error(`[SX] resolveFunctionSymbol: Unresolved symbol: ${t.symbol}.`);return t.symbol}}(e,t):y(e,r[0])))throw new Error(`[SX] evaluate: First item of list is not a function: ${JSON.stringify(r)}.`);r=a(...r.slice(1))}}else if(e.config.wrapExternalValue&&Object.prototype.hasOwnProperty.call(r,"value"))r=r.value;else if(Object.prototype.hasOwnProperty.call(r,"symbol"))r=l(e,r);else if(Object.prototype.hasOwnProperty.call(r,"car")){const t=y(e,r.car),n=y(e,r.cdr);if(Array.isArray(n)){const e=n.slice(0);e.unshift(t),r=e}else r={car:t,cdr:n}}else Object.prototype.hasOwnProperty.call(r,"dotted")?r=[y(e,r.dotted)]:Object.prototype.hasOwnProperty.call(r,"comment")&&(r=[]);return r}},function(e,t,r){"use strict";function n(e,t){return[{symbol:e.config.reservedNames.quote},t]}function o(e,t){if(Array.isArray(t)&&0<t.length){const r=u(t);if(r&&r.symbol===e.config.reservedNames.quote)return!0}return!1}function a(e,t){return[{symbol:e.config.reservedNames.backquote},t]}function s(e,t){if(Array.isArray(t)&&0<t.length){const r=u(t);if(r&&r.symbol===e.config.reservedNames.backquote)return!0}return!1}function c(e,t){return[{symbol:e.config.reservedNames.unquote},t]}function i(e,t){if(Array.isArray(t)&&0<t.length){const r=u(t);if(r&&r.symbol===e.config.reservedNames.unquote)return!0}return!1}function l(e,t){return[{symbol:e.config.reservedNames.spread},t]}function f(e,t){return[{symbol:e.config.reservedNames.splice},t]}function u(e,t){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"symbol")?void 0!==t?e.symbol===t?e:null:e:null}r.d(t,"f",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"i",(function(){return c})),r.d(t,"e",(function(){return i})),r.d(t,"h",(function(){return l})),r.d(t,"g",(function(){return f})),r.d(t,"d",(function(){return u}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return i})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return f})),r.d(t,"b",(function(){return u}));var n=r(2),o=r(1),a=r(0);function s(e,t){let r=t;for(;Array.isArray(r);){{if(0===r.length)break;r=Object(o.i)(e,r);const t=Object(n.d)(r[0]);if(!t)break;{const n=Object(o.h)(e,t,r);if(!n)break;r=n.fn(n.actualArgs)}}Object(a.d)(e)}return r}function c(e,t){if(!Array.isArray(t)||!Object(n.d)(t[0],e.config.reservedNames.quote))throw new Error("[SX] stripQuote: token is not quoted.");return t[1]}function i(e,t){return Array.isArray(t)&&Object(n.d)(t[0],e.config.reservedNames.quote)?t[1]:t}function l(e){return function(){return Object(o.e)(e)}}function f(e,t){return Object(a.b)("(compiler)resolveValueSymbol_dynamic",t),function(){return Object(o.j)(e,{symbol:t})}}function u(e){return function(t){return Object(a.b)(e,t)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a}));class n extends Error{constructor(e){super(e)}}class o extends n{constructor(){super("[SX] evaluate: The maximum count of evaluations has been exceeded.")}}class a extends n{constructor(e){super(`[SX] ${e}: Unexpected termination of script.`)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n=Function("return this")()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return compileLambda}));var _ast__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_evaluate__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),_errors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),_compile_ops_helpers__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3),_compile_ops__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7);function compileCore(e,t,r,n,o){function a(e){let t="";if(null===e)t+="(null)";else if(void 0===e)t+="(void 0)";else switch(typeof e){case"boolean":case"number":t+=`(${String(e)})`;break;case"object":if(Object(_ast__WEBPACK_IMPORTED_MODULE_0__.d)(e)){const r=e;Object(_errors__WEBPACK_IMPORTED_MODULE_2__.c)("(compiler)compileValue",c.varNames,r.symbol),c.varNames.has(r.symbol)?t+=`(${c.varNames.get(r.symbol)})`:(o[c.varsCount]=r.symbol,t+=`(_$_vars[${String(c.varsCount++)}])`);break}default:o[c.varsCount]=e,t+=`(_$_vars[${String(c.varsCount++)}])`}return t}function s(t,r){let n="";const l=t[r];if(Array.isArray(l))if(0<l.length){const t=Object(_compile_ops_helpers__WEBPACK_IMPORTED_MODULE_3__.a)(e,l);if(Array.isArray(t))if(0<t.length)if(Object(_ast__WEBPACK_IMPORTED_MODULE_0__.d)(t[0])){const r=t[0],a=t.slice(1);Object(_errors__WEBPACK_IMPORTED_MODULE_2__.c)("(compiler)compileToken",i,r.symbol),i.has(r.symbol)?n+=i.get(r.symbol)(t,a):r.symbol===e.config.reservedNames.spread?n+=`...(${a.map(t=>s([Object(_compile_ops_helpers__WEBPACK_IMPORTED_MODULE_3__.f)(e,t)],0)).join(",")})`:e.funcMap.has(r.symbol)?(o[c.varsCount]=e.funcMap.get(r.symbol).fn(e,""),n+=`((_$_vars[${String(c.varsCount++)}])(${a.map(t=>s([Object(_compile_ops_helpers__WEBPACK_IMPORTED_MODULE_3__.f)(e,t)],0)).join(",")}))`):c.varNames.has(r.symbol)?n+=`(${String(c.varNames.get(r.symbol))})(${a.map(t=>s([Object(_compile_ops_helpers__WEBPACK_IMPORTED_MODULE_3__.f)(e,t)],0)).join(",")})`:(o[c.varsCount]=Object(_compile_ops_helpers__WEBPACK_IMPORTED_MODULE_3__.d)(e,r.symbol),n+=`((_$_vars[${String(c.varsCount++)}])()(${a.map(t=>s([Object(_compile_ops_helpers__WEBPACK_IMPORTED_MODULE_3__.f)(e,t)],0)).join(",")}))`)}else switch(typeof t[0]){case"function":o[c.varsCount]=t[0],n+=`((_$_vars[${String(c.varsCount++)}])(${t.slice(1).map((t,r,n)=>s([Object(_compile_ops_helpers__WEBPACK_IMPORTED_MODULE_3__.f)(e,t)],0)).join(",")}))`;break;default:throw new Error(`[SX] compileToken: First item of list is not a function: ${JSON.stringify(t[0])}.`)}else n+="([])";else n+=a(l)}else n+="([])";else n+=a(l);return n}const c={_$_vars:o,varsCount:1,varNames:new Map,varNamesCount:0,varDefs:"var x0;",ops:new Map,makeScope:function(e){const t=new Map;for(const e of c.varNames.entries())t.set(e[0],e[1]);e(),c.varNames=t},compileToken:s};Object(_compile_ops__WEBPACK_IMPORTED_MODULE_4__.a)(e,c);const i=c.ops;e.config.enableTailCallOptimization&&(n=Object(_evaluate__WEBPACK_IMPORTED_MODULE_1__.g)(e,t,n)),c.varNames.set(e.config.reservedNames.thiz,"(this===(Function('return this')())?null:(this===void 0?null:this))");const l=Object(_evaluate__WEBPACK_IMPORTED_MODULE_1__.c)(e);if(l)for(const e in l)Object.prototype.hasOwnProperty.call(l,e)&&(o[c.varsCount++]=e,o[c.varsCount]=l[e],c.varNames.set(e,`(_$_vars[${String(c.varsCount)}][_$_vars[${String(c.varsCount-1)}]])`),c.varsCount++);const f=`${t.map((e,n)=>(c.varNames.set(t[n].symbol,"a"+n),`${r&&n===t.length-1?"...":""}a${n}`)).join(",")}`,u=`return(${n.map((e,t)=>s(n,t)).join(",")})`;return`(function(${f}){"strict";${c.varDefs}${u}})`}function evalCompiledLambda(_$_state,_$_vars,code){return _$_vars[0]=eval(code),_$_vars[0]}function compileLambda(e,t,r,n){const o=[];return evalCompiledLambda(e,o,compileCore(e,t,r,n,o))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(2),o=r(0),a=r(3);function s(e,t){const{_$_vars:r,ops:s,makeScope:c,compileToken:i}=t;s.set(e.config.reservedNames.quote,(function(e,n){let o="";return r[t.varsCount]=e[1],o+=`(_$_vars[${String(t.varsCount++)}])`})),s.set(e.config.reservedNames.self,(function(t,r){let n="";return n+=`((_$_vars[0])(${r.map(t=>i([Object(a.f)(e,t)],0)).join(",")}))`})),s.set("$__if",(function(t,r){let n="";return Object(o.a)("compileToken:$__if",r,2,3),n+=`(${i(t,1)}?(${i([Object(a.e)(e,t[2])],0)}):(${i([Object(a.e)(e,t[3])],0)}))`})),s.set("$__if-null",(function(t,r){let n="";return Object(o.a)("compileToken:$__if-null",r,2,2),n+=`((()=>{let _$_rv=${i(t,1)};return _$_rv?_$_rv:(${i([Object(a.e)(e,t[2])],0)}});})())`})),s.set("$__cond",(function(t,r){let n="";Object(o.a)("compileToken:$__cond",r,1),n+="(";for(let t=0;t<r.length;t+=2)n+=`${i([Object(a.e)(e,r[t])],0)}?(${i([Object(a.e)(e,r[t+1])],0)}):(`;n+="null";for(let e=0;e<r.length;e+=2)n+=")";return n+=")"})),s.set("$__while",(function(t,r){let n="";return Object(o.a)("compileToken:$__while",r,1),n+=`((()=>{let _$_rv=null;while(${i([Object(a.e)(e,t[1])],0)}){_$_rv=${t.slice(2).map(t=>i([Object(a.e)(e,t)],0)).join(",")}}return _$_rv})())`})),s.set("$__do-while",(function(t,r){let n="";return Object(o.a)("compileToken:$__do-until",r,1),n+=`((()=>{let _$_rv=null;do{_$_rv=${t.slice(2).map(t=>i([Object(a.e)(e,t)],0)).join(",")}}}while(${i([Object(a.e)(e,t[1])],0)})return _$_rv)())`})),s.set("$__until",(function(t,r){let n="";return Object(o.a)("compileToken:$__until",r,1),n+=`((()=>{let _$_rv=null;while(!${i([Object(a.e)(e,t[1])],0)}){_$_rv=${t.slice(2).map(t=>i([Object(a.e)(e,t)],0)).join(",")}}return _$_rv})())`})),s.set("$__do-until",(function(t,r){let n="";return Object(o.a)("compileToken:$__do-until",r,1),n+=`((()=>{let _$_rv=null;do{_$_rv=${t.slice(2).map(t=>i([Object(a.e)(e,t)],0)).join(",")}}}while(!${i([Object(a.e)(e,t[1])],0)})return _$_rv)())`})),s.set("$__repeat",(function(r,s){let l="";if(Object(o.a)("compileToken:$__repeat",s,2),!Object(n.d)(s[0]))throw new Error("[SX] compileToken: $__repeat : args[0] is not symbol.");return c(()=>{const n="v"+t.varNamesCount++;t.varNames.set(s[0].symbol,n),l+=`(((_$_n)=>{let _$_rv=null;for(let ${n}=0;${n}<_$_n;${n}++){_$_rv=${r.slice(2).map(t=>i([Object(a.e)(e,t)],0)).join(",")}}return _$_rv})(${i(s,1)}))`}),l})),s.set("$__for",(function(r,s){let l="";if(Object(o.a)("compileToken:$__for",s,2),!Object(n.d)(s[0]))throw new Error("[SX] compileToken: $__for : args[0] is not symbol.");return c(()=>{const n="v"+t.varNamesCount++;t.varNames.set(s[0].symbol,n),l+=`(((_$_l)=>{let _$_rv=null;for(const ${n} of _$_l){_$_rv=${r.slice(2).map(t=>i([Object(a.e)(e,t)],0)).join(",")}}return _$_rv})(${i(s,1)}))`}),l})),s.set("$__scope",(function(r,s){let l="";if(Object(o.a)("compileToken:$__scope",s,2),!Array.isArray(r[3]))throw new Error("[SX] compileToken: $__scope : args[2] is not array.");return c(()=>{for(const o of Object(a.e)(e,r[3])){let e="";if(Array.isArray(o)){if(o.length<1)throw new Error("[SX] compileToken: $__scope : args[0][?] is too short.");if(!Object(n.d)(o[0]))throw new Error("[SX] compileToken: $__scope : args[0][?][0] is not symbol.");e=o[0].symbol,l+=`(${"v"+t.varNamesCount}=${i(o,1)})`}else{if(!Object(n.d)(o))throw new Error("[SX] compileToken: $__scope : args[0][?] is not symbol.");e=o.symbol}t.varDefs+=`var v${t.varNamesCount}=void 0;`,t.varNames.set(e,"v"+t.varNamesCount++)}const o=`${r.slice(4).map(t=>i([Object(a.e)(e,t)],0)).join(",")}`;l+=r[2]?`[${o}]`:`(${o})`}),l})),s.set("$__try",(function(n,s){let l="";return Object(o.a)("compileToken:$__try",s,1,2),l+=`((()=>{try{${i([Object(a.e)(e,n[1])],0)}}catch(e${t.varNamesCount}){let e${t.varNamesCount+1}=(_$_vars[${String(t.varsCount)}])();`,r[t.varsCount++]=Object(a.c)(e),c(()=>{t.varNames.set("$error","e"+t.varNamesCount++),t.varNames.set("$parent","e"+t.varNamesCount++),l+=`${i([Object(a.e)(e,n[2])],0)}}})())`}),l})),s.set(e.config.reservedNames.raise,(function(t,r){let n="";return n+=`((()=>{throw ${i([Object(a.f)(e,t[1])],0)}})())`})),s.set("$boolean",(function(e,t){let r="";return Object(o.a)("compileToken:$boolean",t,1,1),r+=`((x0=${i(t,0)}),(Array.isArray(x0)&&x0.length===0?false:boolean(x0)))`})),s.set("$__get",(function(s,c){let l="";Object(o.a)("compileToken:$__get",c,1);const f=Object(a.e)(e,s[1]),u=Object(n.d)(f)?f.symbol:"string"==typeof f?f:null;if("string"!=typeof u)throw new Error(`[SX] compileToken: $__get : operand is not symbol: ${JSON.stringify(s[1])}.`);let m="";t.varNames.has(u)?m=t.varNames.get(u):(r[t.varsCount]=Object(a.d)(e,u),m=`_$_vars[${String(t.varsCount++)}]`);return l+=`((${m})${s.slice(2).map((e,o,a)=>`[${Object(n.d)(a[o])?(e=>(r[t.varsCount]=e,`_$_vars[${String(t.varsCount++)}]`))(a[o].symbol):i(a,o)}]`).join("")})`})),s.set("$__let",(function(r,s){let c="";Object(o.a)("compileToken:$__let",s,2,2);const l=Object(a.e)(e,r[1]),f=Object(n.d)(l)?l.symbol:"string"==typeof l?l:null;if("string"!=typeof f)throw new Error(`[SX] compileToken: $__let : operand is not rvalue: ${JSON.stringify(r[1])}.`);return t.varNames.has(f)||(t.varDefs+=`var v${t.varNamesCount}=void 0;`,t.varNames.set(f,"v"+t.varNamesCount++)),c+=`(${t.varNames.get(f)}=${i(r,2)})`})),s.set("$__set",(function(s,c){let l="";Object(o.a)("compileToken:$__set",c,2);const f=Object(a.e)(e,s[1]),u=Object(n.d)(f)?f.symbol:"string"==typeof f?f:Array.isArray(f)?Object(n.d)(f[0])?f[0].symbol:"string"==typeof f[0]?f[0]:null:null;if("string"!=typeof u)throw new Error(`[SX] compileToken: $__set : operand is not rvalue: ${JSON.stringify(s[1])}.`);let m="";t.varNames.has(u)?m=t.varNames.get(u):(r[t.varsCount]=Object(a.d)(e,u),m=`_$_vars[${String(t.varsCount++)}]`);let b=!1,$="";return l+=`((${m})${(Array.isArray(f)?f.slice(1):[]).map((e,s,c)=>`[${Object(n.d)(c[s])?(e=>(r[t.varsCount]=Object(o.b)("compileToken:$__set",e),`_$_vars[${String(t.varsCount++)}]`))(c[s].symbol):(e=>(b||(r[t.varsCount]=Object(a.b)("compileToken:$__set"),$=String(t.varsCount++),b=!0),`(_$_vars[${$}](${e}))`))(i(c,s))}]`).join("")}=${i(s,2)})`})),s.set(e.config.reservedNames.not,(function(e,t){let r="";return Object(o.a)("compileToken:$not",t,1,1),r+=`(!${i(t,0)})`})),s.set("$__and",(function(t,r){let n="";return Object(o.a)("compileToken:$__and",r,1),n+=`(${r.map(t=>i([Object(a.e)(e,t)],0)).join("&&")})`})),s.set("$__or",(function(t,r){let n="";return Object(o.a)("compileToken:$__or",r,1),n+=`(${r.map(t=>i([Object(a.e)(e,t)],0)).join("||")})`})),s.set("===",(function(e,t){let r="";return Object(o.a)("compileToken:===",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("===")})`})),s.set("!==",(function(e,t){let r="";return Object(o.a)("compileToken:!==",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("!==")})`})),s.set("==",(function(e,t){let r="";return Object(o.a)("compileToken:==",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("==")})`})),s.set("!=",(function(e,t){let r="";return Object(o.a)("compileToken:!=",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("!=")})`})),s.set("<",(function(e,t){let r="";return Object(o.a)("compileToken:<",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("<")})`})),s.set("<=",(function(e,t){let r="";return Object(o.a)("compileToken:<=",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("<=")})`})),s.set(">",(function(e,t){let r="";return Object(o.a)("compileToken:>",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join(">")})`})),s.set(">=",(function(e,t){let r="";return Object(o.a)("compileToken:<=",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join(">=")})`})),s.set("$concat",(function(t,r){let a="";Object(o.a)("compileToken:$concat",r,1);let s="";if(Array.isArray(r[0])&&Object(n.d)(r[0][0],e.config.reservedNames.spread)){const e=i(r[0],1);s=`(${e}[0]).concat((${e}.length>1?${e}[1]:(typeof ${e}[0]==='string'?'':[])),`}else s=`${i(r,0)}.concat(`;return a+=`(${s}${r.slice(1).map((e,t,r)=>i(r,t)).join(",")}))`})),s.set("+",(function(t,r){let a="";Object(o.a)("compileToken:+",r,1);let s=!1;return r.map((t,r,o)=>{Array.isArray(t)&&Object(n.d)(t[0],e.config.reservedNames.spread)&&(s=!0)}),a+=s?`((()=>{let _$_rv=[];${r.map((e,t,r)=>`_$_rv.push(${i(r,t)})`).join(";")};return _$_rv.reduce((x,y)=>x+y);})())`:`(${r.map((e,t,r)=>i(r,t)).join("+")})`})),s.set("-",(function(t,r){let a="";Object(o.a)("compileToken:-",r,1);let s=!1;return r.map((t,r,o)=>{Array.isArray(t)&&Object(n.d)(t[0],e.config.reservedNames.spread)&&(s=!0)}),a+=s?`((()=>{let _$_rv=[];${r.map((e,t,r)=>`_$_rv.push(${i(r,t)})`).join(";")};return (_$_rv.length>1?(_$_rv.reduce((x,y)=>x-y)):(_$_rv.length>0?-_$_rv[0]:NaN));})())`:`(${t.length>2?r.map((e,t,r)=>i(r,t)).join("-"):`-(${String(i(t,1))})`})`})),s.set("*",(function(t,r){let a="";Object(o.a)("compileToken:*",r,2);let s=!1;return r.map((t,r,o)=>{Array.isArray(t)&&Object(n.d)(t[0],e.config.reservedNames.spread)&&(s=!0)}),a+=s?`((()=>{let _$_rv=[];${r.map((e,t,r)=>`_$_rv.push(${i(r,t)})`).join(";")};return _$_rv.reduce((x,y)=>x*y);})())`:`(${r.map((e,t,r)=>i(r,t)).join("*")})`})),s.set("**",(function(t,r){let a="";Object(o.a)("compileToken:**",r,2);let s=!1;return r.map((t,r,o)=>{Array.isArray(t)&&Object(n.d)(t[0],e.config.reservedNames.spread)&&(s=!0)}),a+=s?`((()=>{let _$_rv=[];${r.map((e,t,r)=>`_$_rv.push(${i(r,t)})`).join(";")};return _$_rv.reduce((x,y)=>x**y);})())`:`(${r.map((e,t,r)=>i(r,t)).join("**")})`})),s.set("/",(function(t,r){let a="";Object(o.a)("compileToken:/",r,2);let s=!1;return r.map((t,r,o)=>{Array.isArray(t)&&Object(n.d)(t[0],e.config.reservedNames.spread)&&(s=!0)}),a+=s?`((()=>{let _$_rv=[];${r.map((e,t,r)=>`_$_rv.push(${i(r,t)})`).join(";")};return _$_rv.reduce((x,y)=>x/y);})())`:`(${r.map((e,t,r)=>i(r,t)).join("/")})`})),s.set("%",(function(t,r){let a="";Object(o.a)("compileToken:%",r,2);let s=!1;return r.map((t,r,o)=>{Array.isArray(t)&&Object(n.d)(t[0],e.config.reservedNames.spread)&&(s=!0)}),a+=s?`((()=>{let _$_rv=[];${r.map((e,t,r)=>`_$_rv.push(${i(r,t)})`).join(";")};return _$_rv.reduce((x,y)=>x%y);})())`:`(${r.map((e,t,r)=>i(r,t)).join("%")})`})),s.set("<<",(function(e,t){let r="";return Object(o.a)("compileToken:<<",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("<<")})`})),s.set(">>",(function(e,t){let r="";return Object(o.a)("compileToken:>>",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join(">>")})`})),s.set(">>>",(function(e,t){let r="";return Object(o.a)("compileToken:>>>",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join(">>>")})`})),s.set("$bit-not",(function(e,t){let r="";return Object(o.a)("compileToken:$bit-not",t,1,1),r+=`(~(${i(e,1)}))`})),s.set("$bit-and",(function(e,t){let r="";return Object(o.a)("compileToken:$bit-and",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("&")})`})),s.set("$bit-or",(function(e,t){let r="";return Object(o.a)("compileToken:$bit-or",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("|")})`})),s.set("$bit-xor",(function(e,t){let r="";return Object(o.a)("compileToken:$bit-xor",t,2,2),r+=`(${t.map((e,t,r)=>i(r,t)).join("^")})`}))}},function(e,t,r){e.exports=r(9)},function(e,t,r){"use strict";r.r(t);var n=r(4),o=r(2);const a={eval:"$eval",quote:"$quote",backquote:"$backquote",unquote:"$unquote",spread:"$spread",splice:"$splice",car:"$car",cdr:"$cdr",cons:"$cons",atom:"$atom",eq:"$eq",list:"$list",let:"$clisp-let",lambda:"$lambda",self:"$self",defun:"$defun",thiz:"$this",if:"$if",cond:"$cond",while:"$while",doWhile:"$do-while",until:"$until",doUntil:"$do-until",get:"$get",defvar:"$clisp-defvar",setq:"$clisp-setq",set:"$set",call:"$call",not:"$not",and:"$and",or:"$or",isSymbol:"$is-symbol",gensym:"$gensym",raise:"$raise",catch:"$catch",Template:"Template"},s={raiseOnUnresolvedSymbol:!1,enableEvaluate:!0,enableHereDoc:!0,enableSpread:!0,enableSplice:!0,enableShorthands:!0,enableVerbatimStringLiteral:!0,enableTailCallOptimization:!0,enableRegExpMatchOperators:!0,enableCompilationOperators:!0,stripComments:!1,wrapExternalValue:!0,returnMultipleRoot:!1,maxEvalCount:0,reservedNames:a,symbols:[],macros:[],funcs:[]};function c(e){return"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"eof")}function i(e){return"string"==typeof e&&0===e.trim().length}function l(e){return"string"==typeof e&&/^[0-9\+\-]$/.test(e)}function f(e){return"string"==typeof e&&/^[0-9]$/.test(e)}function u(e){return"string"==typeof e&&!i(e)&&!l(e)}function m(e){return`line: ${e.line} / strings: ${e.index} / pos: ${e.pos} :${e.strings.length>e.index?e.strings[e.index].slice(e.pos,e.pos+20):""}`}function b(e,t,r){if(e.strings.length<=e.index)return{eof:!0};if(e.strings[e.index].length<=e.pos){if(!e.values||e.values.length<=e.index)return e.pos=0,e.index++,b(e);{const t={value:e.values[e.index]};return e.pos=0,e.index++,t}}if(t)for(const r of t){const t=e.strings[e.index].slice(e.pos,e.pos+r.length);if(t===r)return e.pos+=r.length,e.line+=t.split("\n").length-1,{eof:!1,eofSeq:r}}{let t=e.strings[e.index].slice(e.pos,e.pos+1);if(e.pos++,"\n"===t&&e.line++,!r&&"\\"===t){if(e.strings[e.index].length<=e.pos)throw new Error(`[SX] getChar: Invalid syntax at: ${m(e)}.`);switch(t=e.strings[e.index].slice(e.pos,e.pos+1),e.pos++,t){case"b":t="\b";break;case"t":t="\t";break;case"n":t="\n";break;case"v":t="\v";break;case"f":t="\f";break;case"r":t="\r";break;case"U":case"u":if("{"===e.strings[e.index].slice(e.pos,e.pos+1)){let r="";for(let t=0;t<6;t++){const n=e.strings[e.index].slice(e.pos+t,e.pos+1+t);if("}"===n){if(0===t)throw new Error(`[SX] getChar: Invalid syntax at: ${m(e)}.`);e.pos+=t;break}if(!/^[0-9A-Fa-f]{1}$/.test(r))throw new Error(`[SX] getChar: Invalid syntax at: ${m(e)}.`);r+=n}if("}"!==e.strings[e.index].slice(e.pos,e.pos+1))throw new Error(`[SX] getChar: Invalid syntax at: ${m(e)}.`);e.pos++,t=String.fromCodePoint(Number.parseInt(r,16))}else{const r=e.strings[e.index].slice(e.pos,e.pos+4);if(!/^[0-9A-Fa-f]{4}$/.test(r))throw new Error(`[SX] getChar: Invalid syntax at: ${m(e)}.`);e.pos+=4,t=String.fromCodePoint(Number.parseInt(r,16))}}}return t}}function $(e,t,r,n){const o=e.index,a=e.pos,s=e.line,c=[];try{for(let o=0;o<t;o++)c.push(b(e,r,n))}finally{e.index=o,e.pos=a,e.line=s}return c}function p(e,t,r){const n=e.index,o=e.pos,a=e.line;let s;try{s=b(e,t,r)}finally{e.index=n,e.pos=o,e.line=a}return s}function _(e){let t=p(e);for(;!c(t)&&i(t);)b(e),t=p(e)}function d(e,t){let r="",n=p(e,t);for(;!c(n)&&"string"==typeof n;){if(/^0[XxOoBb][0-9]*$/.test(r+n))b(e,t),r+=n;else{if(!/^[0-9\+\-\.EeInfinityNaN]+$/.test(r+n))break;b(e,t),r+=n}n=p(e,t)}if(!/^([\+\-]?\d*\.?\d+(?:[Ee][\+\-]?\d+)?)|(0[XxOoBb][0-9]+)|([\+\-]Infinity)|(NaN)$/.test(r))throw new Error(`[SX] parseNumber: Invalid syntax at: ${m(e)}.`);return Number(r)}function y(e,t){let r="",n=p(e,t);for(;!c(n);){if("string"==typeof n){if(i(n))break;if("#"===n&&"|"===$(e,2,t)[1])break;if(!/^[^.;()"]+$/.test(r+n))break;b(e,t),r+=n}else{if("object"!=typeof n||!Object.prototype.hasOwnProperty.call(n,"value"))throw new Error(`[SX] parseSymbol: Invalid syntax at: ${m(e)}.`);b(e,t);n.value;r+=String(n)}n=p(e,t)}if(e.config.enableShorthands){let t=null;if(t=r.match(/^:((?:\:[^=:]+?)+?)=$/)){const r=t[1].slice(1).split(":");return[{symbol:e.config.reservedNames.splice},[{symbol:e.config.reservedNames.set},r]]}if(t=r.match(/^:((?:\:[^@:]+?)+?)@([^@:]+?)$/)){const r=t[1].slice(1).split(":");return[{symbol:e.config.reservedNames.splice},[{symbol:e.config.reservedNames.call},[{symbol:e.config.reservedNames.get},...r],{symbol:t[2]}]]}if(t=r.match(/^:((?:\:[^:]+?)+?)$/)){const r=t[1].slice(1).split(":");return[{symbol:e.config.reservedNames.get},...r]}}return{symbol:r}}function g(e,t,r,o,a,s){const i=r?[...t,r]:t,l=[],f=[];for(;;){let t="",u=p(e,i,a);for(;!c(u);){if("string"==typeof u)b(e,i,a),t+=u;else{if("object"!=typeof u||!Object.prototype.hasOwnProperty.call(u,"value"))throw new Error(`[SX] parseStringOrComment: Invalid syntax at: ${m(e)}.`);b(e,i,a);u.value;t+=String(u)}u=p(e,i,a)}if(b(e,i,a),!0===u.eof&&!s)throw new n.c("parseStringOrComment");if(l.push(t),u.eofSeq!==r)break;f.push(S(e,o,[]))}return{strings:l,values:f}}function j(e,t){return g(e,['"'],null,")",t,!1).strings[0]}function O(e,t,r){const n=[t];r&&n.push(r);const o=g(e,['"""'],"%%%(",")",!1,!1);for(let e=0;e<o.strings.length;e++)n.push(o.strings[e]),e<o.values.length&&n.push(o.values[e]);return n}function h(e){return{comment:g(e,["\r","\n"],null,")",!1,!0).strings[0]}}function v(e){return{comment:g(e,["|#"],null,")",!1,!1).strings[0]}}function w(e){_(e);let t=p(e);for(;!c(t);){switch(t){case")":throw new Error(`[SX] parseOneToken: Invalid syntax at: ${m(e)}.`);case"(":return b(e),S(e,")",[]);case"'":case"`":case",":{b(e);const r=p(e);let n=!1;","===t&&"@"===r&&(b(e),n=!0),_(e);const a=("'"===t?o.f:"`"===t?o.a:o.i)(e,w(e));return n?Object(o.g)(e,a):a}case".":{b(e);const t=$(e,2);return e.config.enableSpread&&"."===t[0]&&"."===t[1]?(b(e),b(e),_(e),Object(o.h)(e,w(e))):(_(e),{dotted:w(e)})}case";":return b(e),h(e);case"#":return"|"===$(e,2)[1]?(b(e),b(e),v(e)):y(e);case'"':{b(e);const t=$(e,4);if(e.config.enableHereDoc&&'"'===t[0]&&'"'===t[1]){let r=!0;c(t[2])||i(t[2])||(l(t[2])?"+"!==t[2]&&"-"!==t[2]||f(t[3])||(r=!1):u(t[2])&&(r=!1)),b(e),b(e);let n=null,o=null;if(r)n={symbol:e.config.reservedNames.Template};else{if(null===(n=y(e,["@"])))throw new Error(`[SX] parseOneToken: Invalid syntax at: ${m(e)}.`);if("number"==typeof n)throw new Error(`[SX] parseOneToken: Invalid syntax at: ${m(e)}.`);const t=$(e,2);if("@"===t[0]){if("{"!==t[1])throw new Error(`[SX] parseOneToken: Invalid syntax at: ${m(e)}.`);b(e),b(e);const r=S(e,"}",[{symbol:"@"}]);Array.isArray(r)&&(o=r)}}return O(e,n,o)}return j(e,!1)}case"@":if(e.config.enableVerbatimStringLiteral){if('"'===$(e,2)[1])return b(e),b(e),j(e,!0)}default:if("string"!=typeof t){if("object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"value"))return b(e),e.config.wrapExternalValue?t:t.value;throw new Error(`[SX] parseOneToken: Invalid syntax at: ${m(e)}.`)}if(i(t))break;if(l(t)){if("+"===t||"-"===t){if(!f($(e,2)[1]))return y(e)}return d(e)}if(u(t))return y(e);throw new Error(`[SX] parseOneToken: Invalid syntax at: ${m(e)}.`)}_(e),t=p(e)}throw new n.c("parseOneToken")}function S(e,t,r){const o=r.slice(0);let a=!1;_(e);let s=p(e);for(;!c(s);){switch(s){case t:return b(e),a?o[0]:o;default:{const t=w(e);if("object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"dotted")){if(1!==o.length)throw new Error(`[SX] parseList: Invalid syntax at: ${m(e)}.`);a=!0,Array.isArray(t)?(t.unshift(o.pop()),o.push(t)):o.push({car:o.pop(),cdr:t.dotted})}else if("object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"comment"))e.config.stripComments||o.push(t);else{if(a)throw new Error(`[SX] parseList: Invalid syntax at: ${m(e)}.`);o.push(t)}}}_(e),s=p(e)}throw new n.c("parseList")}function A(e){const t=[];_(e);let r=p(e);for(;!c(r);){switch(r){case"(":b(e),t.push(S(e,")",[]));break;case"'":case"`":for(b(e),_(e);;){const n=w(e);if("object"!=typeof n||!Object.prototype.hasOwnProperty.call(n,"comment")){t.push(("'"===r?o.f:o.a)(e,n));break}e.config.stripComments||t.push(n)}break;case";":b(e),e.config.stripComments?h(e):t.push(h(e));break;case"#":"|"===$(e,2)[1]?(b(e),b(e),e.config.stripComments?v(e):t.push(v(e))):(b(e),e.config.stripComments?h(e):t.push(h(e)));break;case'"':{const r=$(e,3);if('"'===r[1]&&'"'===r[2]){t.push(w(e));break}}default:throw new Error(`[SX] parseInitialState: Invalid syntax at: ${m(e)}.`)}_(e),r=p(e)}return t}var E=r(1),N=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function s(e){try{i(n.next(e))}catch(e){a(e)}}function c(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}i((n=n.apply(e,t||[])).next())}))};function I(e,t,r,n){return{strings:"string"==typeof r?[r]:r,values:n||[],index:0,pos:0,line:0,evalCount:0,scopes:[{isBlockLocal:!1,scope:t}],macroMap:new Map(e.macros.map(e=>[e.name,e])),funcMap:new Map(e.funcs.map(e=>[e.name,e])),symbolMap:new Map(e.symbols.map(e=>[e.name,e])),config:e}}function k(e,t,r){return e.strings="string"==typeof t?[t]:t,e.values=r||[],e.index=0,e.pos=0,e.line=0,e.evalCount=0,e}function T(e){let t=e||Object.assign({},s),r={},n=[];const o=(e,r)=>{if(t.enableEvaluate)for(let t=0;t<r.length;t++)r[t]=Object(E.b)(e,r[t]);return t.returnMultipleRoot?1===r.length?r[0]:r:r[r.length-1]},a=(e,...a)=>{const s=I(t,Object.assign({},r),e,a);return o(s,n.concat(A(s)))};return a.evaluateAST=e=>{const a=I(t,Object.assign({},r),"");return o(a,n.concat(e))},a.repl=()=>{const e=I(t,Object.assign({},r),"");o(e,n.slice(0));const a=(t,...r)=>(k(e,t,r),o(e,A(e)));return a.sync=a,a},a.setGlobals=e=>(r=Object.assign({},e||{}),a),a.appendGlobals=e=>(r=Object.assign({},r,e||{}),a),a.setStartup=(e,...o)=>{const s=I(t,Object.assign({},r),e,o);return n=A(s),a},a.setStartupAST=e=>(n=e,a),a.appendStartup=(e,...o)=>{const s=I(t,Object.assign({},r),e,o);return n=n.concat(A(s)),a},a.appendStartupAST=e=>(n=n.concat(e),a),a.install=e=>(t=e(t),a),a}function X(e){let t=e||Object.assign({},s),r={},n=[];const o=(e,r)=>N(this,void 0,void 0,(function*(){if(t.enableEvaluate)for(let t=0;t<r.length;t++)r[t]=Object(E.b)(e,r[t]),"object"==typeof r[t]&&null!==r[t]&&"function"==typeof r[t].then&&(r[t]=yield r[t]);return t.returnMultipleRoot?1===r.length?r[0]:r:r[r.length-1]})),a=(e,...a)=>N(this,void 0,void 0,(function*(){const s=I(t,Object.assign({},r),e,a);return o(s,n.concat(A(s)))}));return a.evaluateAST=e=>{const a=I(t,Object.assign({},r),"");return o(a,n.concat(e))},a.repl=()=>{const e=I(t,Object.assign({},r),"");o(e,n.slice(0));const a=(t,...r)=>N(this,void 0,void 0,(function*(){return k(e,t,r),o(e,A(e))}));return a.sync=(r,...n)=>(k(e,r,n),((e,r)=>{if(t.enableEvaluate)for(let t=0;t<r.length;t++)r[t]=Object(E.b)(e,r[t]);return t.returnMultipleRoot?1===r.length?r[0]:r:r[r.length-1]})(e,A(e))),a},a.setGlobals=e=>(r=Object.assign({},e||{}),a),a.appendGlobals=e=>(r=Object.assign({},r,e||{}),a),a.setStartup=(e,...o)=>{const s=I(t,Object.assign({},r),e,o);return n=A(s),a},a.setStartupAST=e=>(n=e,a),a.appendStartup=(e,...o)=>{const s=I(t,Object.assign({},r),e,o);return n=n.concat(A(s)),a},a.appendStartupAST=e=>(n=n.concat(e),a),a.install=e=>(t=e(t),a),a}const x=(()=>{const e=Object.assign({},s);return e.enableEvaluate=!1,e.returnMultipleRoot=!0,T(e)})();var C=r(5),M=r(6),P=r(0);const D=(e,t)=>(...e)=>{Object(P.a)("$car",e,1,1);const t=R(...e);if(!Array.isArray(t))throw new Error("[SX] $car: Invalid argument(s): args[0] is not array.");if(0===t.length)throw new Error("[SX] $car: Invalid argument(s): args[0] is nil.");return t[0]},L=(D(),(e,t)=>(...e)=>{Object(P.a)("$cdr",e,1,1);const t=R(...e);if(!Array.isArray(t))throw new Error("[SX] $cdr: Invalid argument(s): args[0] is not array.");if(0===t.length)throw new Error("[SX] $cdr: Invalid argument(s): args[0] is nil.");return t.slice(1)}),q=(L(),(e,t)=>(...e)=>{Object(P.a)("$cons",e,2,2);let{car:t,cdr:r}=G(...e);return null===t&&(t=[]),null===r&&(r=[]),Array.isArray(r)?((r=r.slice(0)).unshift(t),r):{car:t,cdr:r}}),U=(q(),(e,t)=>(...e)=>{const t=e.slice(0,1);return 1===t.length?t[0]:null}),R=(...e)=>{const t=e.slice(0,1);return 1===t.length?t[0]:null},F=(e,t)=>(...e)=>{const t=e.slice(1,2);return 1===t.length?t[0]:null},B=(...e)=>{const t=e.slice(1,2);return 1===t.length?t[0]:null},W=(e,t)=>(...e)=>{const t=e.slice(e.length-1,e.length);return 1===t.length?t[0]:null},K=(e,t)=>(...e)=>{const t=e.slice(1);return 0<t.length?t:null},V=(e,t)=>(...e)=>{let t=e.slice(0,1);t=1===t.length?t[0]:null;let r=e.slice(1,2);return{car:t,cdr:r=1===r.length?r[0]:null}},G=(...e)=>{let t=e.slice(0,1);t=1===t.length?t[0]:null;let r=e.slice(1,2);return{car:t,cdr:r=1===r.length?r[0]:null}},J=(e,t)=>(...e)=>{Object(P.a)("$atom",e,1,1);const t=R(...e);if(null==t)return!0;if(Array.isArray(t))return 0===t.length;switch(typeof t){case"number":case"string":case"function":case"boolean":return!0;case"object":return!!Object(o.d)(t)}return!1},H=(J(),(e,t)=>(...e)=>{Object(P.a)("$eq",e,2,2);const{car:t,cdr:r}=G(...e);return t===r}),z=(H(),(e,t)=>(...e)=>{Object(P.a)("$notEq",e,2,2);const{car:t,cdr:r}=G(...e);return t!==r}),Y=(z(),(e,t)=>(...e)=>e.slice(0)),Q=(e,t,r)=>(...t)=>{Object(P.a)("$__scope",t,3);const n=R(...t),a=B(...t),{car:s,cdr:c}=G(...t.slice(2));let i=null;const l={};if(Array.isArray(s))for(const t of s)if(Array.isArray(t)){const r=G(...t),n=Object(o.d)(r.car),a=n?n.symbol:String(r.car);Object(P.c)("$__scope",l,a),l[a]=Object(E.b)(e,r.cdr)}else{const e=Object(o.d)(t),r=e?e.symbol:String(t);Object(P.c)("$__scope",l,r),l[r]=null}Object(E.f)(e,l,n,r);try{if(4<t.length)if(a){i=[];for(const r of t.slice(3))i.push(Object(E.b)(e,r))}else for(const r of t.slice(3))i=Object(E.b)(e,r);else i=Object(E.b)(e,c)}finally{Object(E.m)(e)}return i},Z=(e,t)=>(...t)=>{Object(P.a)("$__lambda",t,2);const r=t[0];if(!Array.isArray(r))throw new Error("[SX] $__lambda: Invalid argument(s): args[0] is not array.");let n=!1;for(let t=0;t<r.length;t++){const a=r[t];if(t===r.length-1&&e.config.enableSpread&&Array.isArray(a)&&Object(o.d)(a[0],e.config.reservedNames.spread)){if(!Object(o.d)(a[1]))throw new Error(`[SX] $__lambda: Invalid formal argument(s): item(s) of args[${t}] is not symbol.`);r[t]=a[1],n=!0}else if(!Object(o.d)(a))throw new Error(`[SX] $__lambda: Invalid formal argument(s): item(s) of args[${t}] is not symbol.`)}let a=t.slice(1);e.config.enableTailCallOptimization&&(a=Object(E.g)(e,r,a));const s=Object(E.c)(e),c=function(...t){if(t.length+(n?1:0)<r.length)throw new Error(`[SX] func call: Actual args too short: actual ${t.length} / formal ${r.length}.`);return Q(e,0,s)(!1,!1,[[e.config.reservedNames.self,c],[e.config.reservedNames.thiz,this===C.a||void 0===this?null:Object(o.f)(e,this)],...r.map((a,s)=>[a.symbol,Object(o.f)(e,n&&s===r.length-1?t.slice(s):t[s])])],...a)};return c},ee=(e,t)=>(...t)=>{Object(P.a)("$$__lambda",t,2);const r=t[0];if(!Array.isArray(r))throw new Error("[SX] $$__lambda: Invalid argument(s): args[0] is not array.");let n=!1;for(let t=0;t<r.length;t++){const a=r[t];if(t===r.length-1&&e.config.enableSpread&&Array.isArray(a)&&Object(o.d)(a[0],e.config.reservedNames.spread)){if(!Object(o.d)(a[1]))throw new Error(`[SX] $$__lambda: Invalid formal argument(s): item(s) of args[${t}] is not symbol.`);r[t]=a[1],n=!0}else if(!Object(o.d)(a))throw new Error(`[SX] $$__lambda: Invalid formal argument(s): item(s) of args[${t}] is not symbol.`)}const a=t.slice(1);return Object(M.a)(e,r,n,a)},te=(e,t)=>(...e)=>{Object(P.a)("$apply",e,1);const t=R(...e);if("function"!=typeof t)throw new Error("[SX] $apply: Invalid argument(s): args[0] is not function.");return(...r)=>t.apply(null,e.slice(1).concat(r))},re=(te(),(e,t)=>(...e)=>{throw R(...e)}),ne=(re(),(e,t)=>(...e)=>{Object(P.a)("$pipe",e,1);let t=e[0];for(let r=1;r<e.length;r++)t=e[r](t);return t}),oe=(ne(),(e,t)=>(...t)=>{Object(P.a)("$__let",t,2,2);let r=Object(o.d)(R(...t));if(!r){if("string"!=typeof t[0])throw new Error("[SX] $__let: Invalid argument(s): invalid name.");r={symbol:t[0]}}return Object(P.c)("$__let",{},r.symbol),Object(E.k)(e,r,!1)[r.symbol]=t[1],t[1]}),ae=(e,t)=>(...t)=>{Object(P.a)("$__set",t,2,2);let r=[];Array.isArray(t[0])?r=t[0]:r.push(t[0]);let n=Object(o.d)(r[0]);if(!n){if("string"!=typeof r[0])throw new Error("[SX] $__set: Invalid argument(s): invalid name.");Object(P.c)("$__set",{},r[0]),n={symbol:r[0]}}let a=Object(E.k)(e,n,!0);if(null===a)throw new Error(`[SX] $__set: Unresolved symbol: ${n.symbol}.`);let s=!1;for(let c=0;c<r.length;c++){let i=r[c],l=!0;const f=c===r.length-1;for(;l;)switch(typeof i){case"function":a=i(a),l=!1;break;case"object":if(Array.isArray(i))i=Object(E.b)(e,i);else if(n=Object(o.d)(i))i=n.symbol;else{if(!Object.prototype.hasOwnProperty.call(i,"value"))throw new Error("[SX] $__set: Invalid argument(s): invalid name.");i=Object(E.b)(e,i)}break;case"number":i<0&&(i=a.length+i);case"string":Object(P.c)("$__set",a,i),f?(a[i]=t[1],s=!0):a=a[i],l=!1;break;default:throw new Error("[SX] $__set: Invalid argument(s): invalid name.")}}if(!s)throw new Error("[SX] $__set: Invalid argument(s): last path is not lvalue.");return t[1]},se=(e,t)=>(...e)=>{Object(P.a)("$boolean",e,1,1);const t=R(...e);return(!Array.isArray(t)||0!==t.length)&&Boolean(t)},ce=se(),ie=(e,t)=>(...e)=>(Object(P.a)("$not",e,1,1),!ce(...e)),le=ie(),fe=(e,t)=>(...t)=>{Object(P.a)("$__and",t,1);let r=null;for(let n=0;n<t.length;n++){const o=Object(E.b)(e,t[n]);if(!ce(o))return o;r=o}return r},ue=(fe(null),(e,t)=>(...t)=>{Object(P.a)("$__or",t,1);let r=null;for(let n=0;n<t.length;n++){const o=Object(E.b)(e,t[n]);if(ce(o))return o;r=o}return r}),me=(ue(null),(e,t)=>(...e)=>{Object(P.a)("$ambiguousEq",e,2,2);let{car:t,cdr:r}=G(...e);return Array.isArray(t)&&0===t.length&&(t=null),Array.isArray(r)&&0===r.length&&(r=null),void 0===t&&(t=null),void 0===r&&(r=null),t==r}),be=me(),$e=(e,t)=>(...e)=>!be(...e),pe=($e(),(e,t)=>(...e)=>{Object(P.a)("$lt",e,2,2);const{car:t,cdr:r}=G(...e);return Object(E.l)(t)<Object(E.l)(r)}),_e=(pe(),(e,t)=>(...e)=>{Object(P.a)("$le",e,2,2);const{car:t,cdr:r}=G(...e);return Object(E.l)(t)<=Object(E.l)(r)}),de=(_e(),(e,t)=>(...e)=>{Object(P.a)("$gt",e,2,2);const{car:t,cdr:r}=G(...e);return Object(E.l)(t)>Object(E.l)(r)}),ye=(de(),(e,t)=>(...e)=>{Object(P.a)("$ge",e,2,2);const{car:t,cdr:r}=G(...e);return Object(E.l)(t)>=Object(E.l)(r)}),ge=(ye(),(e,t)=>(...e)=>{Object(P.a)("$typeof",e,1,1);const t=R(...e);if(null===t)return"null";const r=typeof t;switch(r){case"object":return Array.isArray(t)?"list":"object";case"symbol":return"js-symbol";default:return r}}),je=(ge(),(e,t)=>(...e)=>{if(Object(P.a)("$symbol",e,1,1),"string"==typeof e[0])return{symbol:e[0]};throw new Error("[SX] $symbol: Invalid argument(s): item(s) of args[0] is not string.")}),Oe=(je(),(e,t)=>(...e)=>{if(Object(P.a)("$isSymbol",e,1,2),1===e.length)return!!Object(o.d)(e[0]);if("string"==typeof e[1])return!!Object(o.d)(e[0],e[1]);throw new Error("[SX] $isSymbol: Invalid argument(s): item(s) of args[1] is not string.")}),he=(Oe(),(e,t)=>(...e)=>(Object(P.a)("$isNull",e,1,1),null===R(...e))),ve=(he(),(e,t)=>(...e)=>{Object(P.a)("$isNil",e,1,1);const t=R(...e);return Array.isArray(t)&&0===t.length}),we=(ve(),(e,t)=>(...e)=>(Object(P.a)("$isUndefined",e,1,1),void 0===R(...e))),Se=(we(),(e,t)=>(...e)=>(Object(P.a)("$isList",e,1,1),Array.isArray(R(...e)))),Ae=(Se(),(e,t)=>(...e)=>(Object(P.a)("$isString",e,1,1),"string"==typeof R(...e))),Ee=(Ae(),(e,t)=>(...e)=>(Object(P.a)("$isNumber",e,1,1),"number"==typeof R(...e))),Ne=(Ee(),(e,t)=>(...e)=>(Object(P.a)("$isNaN",e,1,1),Number.isNaN(R(...e)))),Ie=(Ne(),(e,t)=>(...e)=>(Object(P.a)("$isFinite",e,1,1),Number.isFinite(R(...e)))),ke=(Ie(),(e,t)=>(...e)=>(Object(P.a)("$isInteger",e,1,1),Number.isInteger(R(...e)))),Te=(ke(),(e,t)=>(...e)=>(Object(P.a)("$toString",e,1,1),String(R(...e)))),Xe=(Te(),(e,t)=>(...e)=>(Object(P.a)("$toNumber",e,1,1),Object(E.l)(R(...e)))),xe=(Xe(),[C.a,Object.__proto__,{}.__proto__,Function.__proto__]),Ce=(e,t)=>(...e)=>{if(Object(P.a)("$objectAssign",e,1),xe.includes(e[0]))throw new Error("[SX] $objectAssign: Invalid argument: args[0] is blacklisted object.");return Object.assign(e[0],...e.slice(1))},Me=(Ce(),(e,t)=>(...e)=>(Object(P.a)("$jsonStringify",e,1,1),JSON.stringify(R(...e)))),Pe=(Me(),(e,t)=>(...e)=>{Object(P.a)("$jsonParse",e,1,1);const t=R(...e);if("string"!=typeof t)throw new Error("[SX] $jsonParse: Invalid argument(s): args[0] is not string.");return JSON.parse(t)}),De=(Pe(),(e,t)=>(...e)=>Date.now()),Le=(De(),(e,t)=>(...e)=>{Object(P.a)("$datetimeFromIso",e,1,1);const t=R(...e);if("string"!=typeof t)throw new Error("[SX] $datetimeFromIso: Invalid argument(s): args[0] is not string.");if(!/^(?:(?:-[0-9]{6,})|[0-9]{4,})-(?:[0-1][0-9])-(?:[0-3][0-9])(?:T(?:[0-2][0-9])(?:[:](?:[0-6][0-9])(?:[:](?:[0-6][0-9])(?:.[0-9]{1,})?)?)?(?:Z|[-+][0-9]{2}(?:[:]?[0-6][0-9])?)?)?$/.test(t))throw new Error(`[SX] $datetimeFromIso: Invalid datetime (pattern unmatched): ${t}.`);const r=new Date(t).getTime();if(Number.isNaN(r))throw new Error(`[SX] $datetimeFromIso: Invalid datetime: ${t}.`);return r}),qe=(Le(),(e,t)=>(...e)=>{Object(P.a)("$datetime",e,3,7);let t="";const r=Number(e[0]);t+=r>=0?String(r).padStart(4,"0"):"-"+String(-r).padStart(6,"0"),t+="-"+String(Number(e[1])).padStart(2,"0"),t+="-"+String(Number(e[2])).padStart(2,"0"),e.length>=4&&(t+="T"+String(Number(e[3])).padStart(2,"0"),e.length>=5?t+=":"+String(Number(e[4])).padStart(2,"0"):t+=":00",e.length>=6&&(t+=":"+String(Number(e[5])).padStart(2,"0")),e.length>=7&&(t+="."+String(Number(e[6])).padStart(3,"0").slice(0,3)),t+="Z");const n=new Date(t).getTime();if(Number.isNaN(n))throw new Error(`[SX] $datetime: Invalid datetime: ${t}.`);return n}),Ue=(qe(),(e,t)=>(...e)=>{Object(P.a)("$datetimeLc",e,3,7);let t="";const r=Number(e[0]);t+=r>=0?String(r).padStart(4,"0"):"-"+String(-r).padStart(6,"0"),t+="-"+String(Number(e[1])).padStart(2,"0"),t+="-"+String(Number(e[2])).padStart(2,"0"),e.length>=4?(t+="T"+String(Number(e[3])).padStart(2,"0"),e.length>=5?t+=":"+String(Number(e[4])).padStart(2,"0"):t+=":00",e.length>=6&&(t+=":"+String(Number(e[5])).padStart(2,"0")),e.length>=7&&(t+="."+String(Number(e[6])).padStart(3,"0").slice(0,3))):t+="T00:00:00.000";const n=new Date(t).getTime();if(Number.isNaN(n))throw new Error(`[SX] $datetimeLc: Invalid datetime: ${t}.`);return n}),Re=(Ue(),(e,t)=>(...e)=>{Object(P.a)("$datetimeToIsoString",e,1,1);const t=R(...e);if("number"!=typeof t)throw new Error("[SX] $datetimeToIsoString: Invalid argument(s): args[0] is not number.");const r=new Date(t);if(Number.isNaN(r.getTime()))throw new Error(`[SX] $datetimeToIsoString: Invalid datetime: ${t}.`);return r.toISOString()}),Fe=(Re(),(e,t)=>(...e)=>{Object(P.a)("$datetimeToComponents",e,1,1);const t=R(...e);if("number"!=typeof t)throw new Error("[SX] $datetimeToComponents: Invalid argument(s): args[0] is not number.");const r=new Date(t);if(Number.isNaN(r.getTime()))throw new Error(`[SX] $datetimeToComponents: Invalid datetime: ${t}.`);return[r.getUTCFullYear(),r.getUTCMonth()+1,r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds(),0,r.getUTCDay()]}),Be=(Fe(),(e,t)=>(...e)=>{Object(P.a)("$datetimeToComponentsLc",e,1,1);const t=R(...e);if("number"!=typeof t)throw new Error("[SX] $datetimeToComponentsLc: Invalid argument(s): args[0] is not number.");const r=new Date(t);if(Number.isNaN(r.getTime()))throw new Error(`[SX] $datetimeToComponentsLc: Invalid datetime: ${t}.`);return[r.getFullYear(),r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds(),-r.getTimezoneOffset(),r.getDay()]}),We=(Be(),(e,t)=>(...t)=>{if(Object(P.a)("$match",t,2,3),!e.config.enableRegExpMatchOperators)throw new Error("[SX] $match: Operator is disabled by configuration.");if(2===t.length){return new RegExp(t[0]).exec(t[1])}return new RegExp(t[0],t[1]).exec(t[2])}),Ke=(We(null),(e,t)=>(...e)=>(console.log(...e),null)),Ve=(Ke(),(e,t)=>(...e)=>(console.error(...e),null)),Ge=(Ve(),(e,t)=>(...e)=>(console.trace(...e),null)),Je=(Ge(),(e,t)=>(...e)=>(console.time(...e),null)),He=(Je(),(e,t)=>(...e)=>(console.timeEnd(...e),null)),ze=(He(),(e,t)=>(...e)=>(console.timeLog(...e),null)),Ye=(ze(),[{name:"$car",fn:D},{name:"$cdr",fn:L},{name:"$cons",fn:q},{name:"$first",fn:U},{name:"$second",fn:F},{name:"$last",fn:W},{name:"$progn",fn:W},{name:"$rest",fn:K},{name:"$first-and-second",fn:V},{name:"$atom",fn:J},{name:"$eq",fn:H},{name:"===",fn:H},{name:"$not-eq",fn:z},{name:"!==",fn:z},{name:"$list",fn:Y},{name:"$__scope",fn:Q},{name:"$__global",fn:(e,t)=>(...t)=>{Object(P.a)("$__globalScope",t,1);const r=R(...t),n=B(...t);let o=null;Object(E.f)(e,Object(E.d)(e).scope,!0);try{if(2<t.length)if(r){o=[];for(const r of t.slice(1))o.push(Object(E.b)(e,r))}else for(const r of t.slice(1))o=Object(E.b)(e,r);else o=Object(E.b)(e,n)}finally{Object(E.m)(e)}return o}},{name:"$__capture",fn:(e,t)=>(...t)=>{Object(P.a)("$__capture",t,1);const r=t[0];if(!Array.isArray(r))throw new Error("[SX] $__lambda: Invalid argument(s): args[0] is not array.");let n=null;const o=Object(E.a)(e,r);Object(E.f)(e,{},!0,o);try{for(const r of t.slice(1))n=Object(E.b)(e,r)}finally{Object(E.m)(e)}return n}},{name:"$__lambda",fn:Z},{name:"$__defun",fn:(e,t)=>(...t)=>{Object(P.a)("$__defun",t,3);const r=R(...t),n=Z(e)(...t.slice(1));return Object(P.c)("$__defun",e.funcMap,r.symbol),e.funcMap.set(r.symbol,{name:r.symbol,fn:(e,t)=>n}),n}},{name:"$__refun",fn:(e,t)=>(...t)=>{Object(P.a)("$__refun",t,1,1);const r=R(...t);Object(P.c)("$__refun",e.funcMap,r.symbol);const n=e.funcMap.get(r.symbol);if(!n)throw new Error(`[SX] $__refun: function ${r.symbol} is not defined.`);return n.fn(e,r.symbol)}},{name:"$__defmacro",fn:(e,t)=>(...t)=>{Object(P.a)("$__defmacro",t,3);const r=R(...t),n=t[1];if(!Array.isArray(n))throw new Error("[SX] $__defmacro: Invalid argument(s): args[1] is not array.");let a=!1;for(let t=0;t<n.length;t++){const r=n[t];if(t===n.length-1&&e.config.enableSpread&&Array.isArray(r)&&Object(o.d)(r[0],e.config.reservedNames.spread)){if(!Object(o.d)(r[1]))throw new Error(`[SX] $__defmacro: Invalid formal argument(s): item(s) of args[${t}] is not symbol.`);n[t]=r[1],a=!0}else if(!Object(o.d)(r))throw new Error(`[SX] $__defmacro: Invalid formal argument(s): item(s) of args[${t}] is not symbol.`)}const s=t.slice(2),c=Object(E.c)(e),i=t=>(...r)=>Q(e,0,c)(!1,!1,[[e.config.reservedNames.self,i],...t.map((n,s)=>[n.symbol,Object(o.f)(e,a&&s===t.length-1?r.slice(s):r[s])])],...s),l={name:r.symbol,fn:(e,t,r)=>e=>i(r)(...e.slice(1)),formalArgs:n,lastIsSpread:a};if(Object(P.c)("$__defmacro",e.macroMap,r.symbol),e.macroMap.has(r.symbol)){let t=e.macroMap.get(r.symbol);if(t.next=l,t&&t.formalArgs)if(t.formalArgs.length<n.length)e.macroMap.set(r.symbol,l),l.next=t;else{let e=t;for(t=t.next;t;){if(t.formalArgs&&t.formalArgs.length<n.length){e.next=l,l.next=t;break}e=t,t=t.next}}}else e.macroMap.set(r.symbol,l);return i}},{name:"$apply",fn:te},{name:"$__call",fn:(e,t)=>(...t)=>{Object(P.a)("$__call",t,2);const{car:r,cdr:n}=G(...t),a=Object(o.d)(n),s=a?a.symbol:Object(E.b)(e,n);return Object(P.c)("$__call",r,s),Function.prototype.apply.call(r[s],r,t.slice(2))}},{name:"$__try",fn:(e,t)=>(...t)=>{Object(P.a)("$__try",t,1,2);let r=[];try{r=Object(E.b)(e,t[0])}catch(a){if(a instanceof n.a)throw a;r=1<t.length?Q(e)(!0,!1,[["$error",Object(o.f)(e,a)],["$parent",Object(o.f)(e,Object(E.e)(e))]],t[1]):null}return r}},{name:"$raise",fn:re},{name:"$__if",fn:(e,t)=>(...t)=>{Object(P.a)("$__if",t,2,3);const r=R(...t);let n=[];return n=ce(r)?Object(E.b)(e,t[1]):2<t.length?Object(E.b)(e,t[2]):null}},{name:"$__if-null",fn:(e,t)=>(...t)=>{Object(P.a)("$__ifNull",t,2,2);const{car:r,cdr:n}=G(...t);let o=[];return o=be(r,null)?Object(E.b)(e,n):r}},{name:"$__cond",fn:(e,t)=>(...t)=>{Object(P.a)("$__cond",t,1);for(let r=0;r<t.length-1;r+=2){const n=t[r],o=t[r+1];if(ce(Object(E.b)(e,n)))return Object(E.b)(e,o)}return null}},{name:"$__while",fn:(e,t)=>(...t)=>{Object(P.a)("$__while",t,1);const r=R(...t),n=t.slice(1);let o=null;for(;ce(Object(E.b)(e,r));)for(const t of n)o=Object(E.b)(e,t);return o}},{name:"$__do-while",fn:(e,t)=>(...t)=>{Object(P.a)("$__doWhile",t,1);const r=R(...t),n=t.slice(1);let o=null;do{for(const t of n)o=Object(E.b)(e,t)}while(ce(Object(E.b)(e,r)));return o}},{name:"$__until",fn:(e,t)=>(...t)=>{Object(P.a)("$__until",t,1);const r=R(...t),n=t.slice(1);let o=null;for(;le(Object(E.b)(e,r));)for(const t of n)o=Object(E.b)(e,t);return o}},{name:"$__do-until",fn:(e,t)=>(...t)=>{Object(P.a)("$__doUntil",t,1);const r=R(...t),n=t.slice(1);let o=null;do{for(const t of n)o=Object(E.b)(e,t)}while(le(Object(E.b)(e,r)));return o}},{name:"$__repeat",fn:(e,t)=>(...t)=>{Object(P.a)("$__repeat",t,2);const r=Object(o.d)(R(...t));if(!r)throw new Error("[SX] $__repeat: Invalid argument(s): item(s) of args[0] is not symbol.");Object(P.c)("$__repeat",{},r.symbol);const n=Object(E.k)(e,r,!1),a=Object(E.l)(B(...t)),s=t.slice(2);let c=null;for(let t=0;t<a;t++){n[r.symbol]=t;for(const t of s)c=Object(E.b)(e,t)}return c}},{name:"$__for",fn:(e,t)=>(...t)=>{Object(P.a)("$__for",t,2);const r=Object(o.d)(R(...t));if(!r)throw new Error("[SX] $__for: Invalid argument(s): item(s) of args[0] is not symbol.");Object(P.c)("$__for",{},r.symbol);const n=Object(E.k)(e,r,!1),a=B(...t);if(!Array.isArray(a))throw new Error("[SX] $__for: Invalid argument(s): item(s) of args[1] is not array.");const s=t.slice(2);let c=null;for(const t of a){n[r.symbol]=t;for(const t of s)c=Object(E.b)(e,t)}return c}},{name:"$pipe",fn:ne},{name:"$__get",fn:(e,t)=>(...t)=>{Object(P.a)("$__get",t,1);let r=null,n=Object(o.d)(t[0]);if(!n)switch(typeof t[0]){case"string":case"number":n={symbol:String(t[0])};break;default:r=Object(E.b)(e,t[0])}if(n){const t=Object(E.k)(e,n,!0);if(!t)throw new Error(`[SX] $__get: Invalid argument(s): args[0]: symbol "${n.symbol}" is not defined.`);r=t[n.symbol]}for(let a=1;a<t.length;a++){let s=t[a],c=!0;for(;c;)switch(typeof s){case"function":r=s(r),c=!1;break;case"object":if(Array.isArray(s))s=Object(E.b)(e,s);else if(n=Object(o.d)(s))s=n.symbol;else{if(!Object.prototype.hasOwnProperty.call(s,"value"))throw new Error("[SX] $__get: Invalid argument(s): invalid name path.");s=Object(E.b)(e,s)}break;case"number":s<0&&(s=r.length+s);case"string":Object(P.c)("$__get",r,s),r=r[s],c=!1;break;default:throw new Error("[SX] $__get: Invalid argument(s): invalid name path.")}}return r}},{name:"$__let",fn:oe},{name:"$__set",fn:ae},{name:"$boolean",fn:se},{name:"$not",fn:ie},{name:"$__and",fn:fe},{name:"$__or",fn:ue},{name:"==",fn:me},{name:"!=",fn:$e},{name:"<",fn:pe},{name:"<=",fn:_e},{name:">",fn:de},{name:">=",fn:ye},{name:"$typeof",fn:ge},{name:"$symbol",fn:je},{name:"$__gensym",fn:(e,t)=>(...t)=>{Object(P.a)("$__gensym",t,0,1);const r={symbol:`${`$__tempvar__$$ec${e.evalCount++}$$_`}_$gensym`};if(1===t.length){const n=Object(o.d)(t[0]);if(n)oe(e)(n,r);else{if("string"!=typeof t[0])throw new Error("[SX] $__gensym: Invalid argument(s): item(s) of args[0] is not symbol.");oe(e)({symbol:t[0]},r)}}return r}},{name:"$is-symbol",fn:Oe},{name:"$is-null",fn:he},{name:"$is-nil",fn:ve},{name:"$is-undefined",fn:we},{name:"$is-list",fn:Se},{name:"$is-string",fn:Ae},{name:"$is-number",fn:Ee},{name:"$is-NaN",fn:Ne},{name:"$is-finite",fn:Ie},{name:"$is-integer",fn:ke},{name:"$to-string",fn:Te},{name:"$to-number",fn:Xe},{name:"$__#",fn:(e,t)=>(...t)=>{const r={};for(const n of t){if(!(Array.isArray(n)&&0<n.length))throw new Error("[SX] $__toObject: Invalid argument(s): args[?] is not array.");{const t=Object(o.d)(n[0]),a=t?t.symbol:String(Object(E.b)(e,n[0]));Object(P.c)("$__#",r,a),1===n.length?r[a]=!0:2===n.length?r[a]=Object(E.b)(e,n[1]):r[a]=Object(E.b)(e,[{symbol:e.config.reservedNames.list}].concat(n.slice(1)))}}return r}},{name:"$object-assign",fn:Ce},{name:"$json-stringify",fn:Me},{name:"$now",fn:De},{name:"$datetime-from-iso",fn:Le},{name:"$datetime",fn:qe},{name:"$datetime-lc",fn:Ue},{name:"$datetime-to-iso-string",fn:Re},{name:"$datetime-to-components",fn:Fe},{name:"$datetime-to-components-lc",fn:Be},{name:"$json-parse",fn:Pe},{name:"$match",fn:We},{name:"$console-log",fn:Ke},{name:"$console-error",fn:Ve},{name:"$console-trace",fn:Ge},{name:"$console-time",fn:Je},{name:"$console-time-end",fn:He},{name:"$console-time-log",fn:ze}]),Qe=[{name:"$$__lambda",fn:ee},{name:"$$__defun",fn:(e,t)=>(...t)=>{Object(P.a)("$$__defun",t,3);const r=R(...t),n=ee(e)(...t.slice(1));return Object(P.c)("$$__defun",e.funcMap,r.symbol),e.funcMap.set(r.symbol,{name:r.symbol,fn:(e,t)=>n}),n}}];var Ze=[].concat(Ye,Qe);const et=[{name:"$scope",fn:(e,t)=>t=>[{symbol:"$__scope"},t[1],t[2],...t.slice(3).map(t=>Object(o.f)(e,t))]},{name:"$local",fn:(e,t)=>t=>[{symbol:"$__scope"},!0,!1,...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$global",fn:(e,t)=>t=>[{symbol:"$__global"},!1,...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$clisp-let",fn:(e,t)=>t=>[{symbol:"$__scope"},!0,!1,...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$capture",fn:(e,t)=>t=>[{symbol:"$__capture"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$closure",fn:(e,t)=>t=>{if(!Object(o.d)(t[2],"use"))throw new Error("[SX] $closure: Invalid syntax: missing 'use' keyword.");return[{symbol:"$__capture"},Object(o.f)(e,t[3]),Object(o.f)(e,[{symbol:"$__lambda"},Object(o.f)(e,t[1]),...t.slice(4).map(t=>Object(o.f)(e,t))])]}},{name:"|->",fn:(e,t)=>e=>[{symbol:"$closure"},...e.slice(1)]},{name:"$lambda",fn:(e,t)=>t=>[{symbol:"$__lambda"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"->",fn:(e,t)=>t=>[{symbol:"$__lambda"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$defun",fn:(e,t)=>t=>[{symbol:"$__defun"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$refun",fn:(e,t)=>t=>[{symbol:"$__refun"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"<-",fn:(e,t)=>t=>[{symbol:"$__refun"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$defmacro",fn:(e,t)=>t=>[{symbol:"$__defmacro"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$call",fn:(e,t)=>t=>(Object(P.a)("$call",t,3),[{symbol:"$__call"},t[1],Object(o.f)(e,t[2]),...t.slice(3)])},{name:"$try",fn:(e,t)=>t=>[{symbol:"$__try"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$if",fn:(e,t)=>t=>[{symbol:"$__if"},t[1],...t.slice(2).map(t=>Object(o.f)(e,t))]},{name:"$if-null",fn:(e,t)=>t=>[{symbol:"$__if-null"},t[1],...t.slice(2).map(t=>Object(o.f)(e,t))]},{name:"??",fn:(e,t)=>t=>[{symbol:"$__if-null"},t[1],...t.slice(2).map(t=>Object(o.f)(e,t))]},{name:"$cond",fn:(e,t)=>t=>[{symbol:"$__cond"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$while",fn:(e,t)=>t=>[{symbol:"$__while"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$do-while",fn:(e,t)=>t=>[{symbol:"$__do-while"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$until",fn:(e,t)=>t=>[{symbol:"$__until"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$do-until",fn:(e,t)=>t=>[{symbol:"$__do-until"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$repeat",fn:(e,t)=>t=>{if(!Object(o.d)(t[2],"of"))throw new Error("[SX] $repeat: Invalid syntax: missing 'of' keyword.");return[{symbol:"$__repeat"},Object(o.f)(e,t[1]),t[3],...t.slice(4).map(t=>Object(o.f)(e,t))]}},{name:"$for",fn:(e,t)=>t=>{if(!Object(o.d)(t[2],"of"))throw new Error("[SX] $for: Invalid syntax: missing 'of' keyword.");return[{symbol:"$__for"},Object(o.f)(e,t[1]),t[3],...t.slice(4).map(t=>Object(o.f)(e,t))]}},{name:"$get",fn:(e,t)=>t=>[{symbol:"$__get"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$let",fn:(e,t)=>t=>(Object(P.a)("$let",t,3,3),[{symbol:"$__let"},Object(o.f)(e,t[1]),t[2]])},{name:"$clisp-defvar",fn:(e,t)=>t=>(Object(P.a)("$clisp-defvar",t,3,3),[{symbol:"$global"},[{symbol:"$__let"},Object(o.f)(e,t[1]),t[2]]])},{name:"$set",fn:(e,t)=>t=>(Object(P.a)("$set",t,3,3),[{symbol:"$__set"},Object(o.f)(e,t[1]),t[2]])},{name:"$clisp-setq",fn:(e,t)=>t=>(Object(P.a)("$clisp-setq",t,3,3),[{symbol:"$__set"},Object(o.f)(e,t[1]),t[2]])},{name:"$and",fn:(e,t)=>t=>[{symbol:"$__and"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$or",fn:(e,t)=>t=>[{symbol:"$__or"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$gensym",fn:(e,t)=>t=>[{symbol:"$__gensym"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"#",fn:(e,t)=>t=>[{symbol:"$__#"},...t.slice(1).map(t=>Object(o.f)(e,t))]}],tt=[{name:"$$closure",fn:(e,t)=>t=>{if(!Object(o.d)(t[2],"use"))throw new Error("[SX] $closure: Invalid syntax: missing 'use' keyword.");return[{symbol:"$__capture"},Object(o.f)(e,t[3]),Object(o.f)(e,[{symbol:"$$__lambda"},Object(o.f)(e,t[1]),...t.slice(4).map(t=>Object(o.f)(e,t))])]}},{name:"|=>",fn:(e,t)=>e=>[{symbol:"$$closure"},...e.slice(1)]},{name:"$$lambda",fn:(e,t)=>t=>[{symbol:"$$__lambda"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"=>",fn:(e,t)=>t=>[{symbol:"$$__lambda"},...t.slice(1).map(t=>Object(o.f)(e,t))]},{name:"$$defun",fn:(e,t)=>t=>[{symbol:"$$__defun"},...t.slice(1).map(t=>Object(o.f)(e,t))]}];var rt=[].concat(et,tt);var nt=[{name:"nil",fn:(e,t)=>[]},{name:"null",fn:(e,t)=>null},{name:"undefined",fn:(e,t)=>void 0},{name:"true",fn:(e,t)=>!0},{name:"#true",fn:(e,t)=>!0},{name:"#t",fn:(e,t)=>!0},{name:"false",fn:(e,t)=>!1},{name:"#false",fn:(e,t)=>!1},{name:"#f",fn:(e,t)=>!1},{name:"#Number:Infinity",fn:(e,t)=>Number.POSITIVE_INFINITY},{name:"+Infinity",fn:(e,t)=>Number.POSITIVE_INFINITY},{name:"-Infinity",fn:(e,t)=>Number.NEGATIVE_INFINITY},{name:"#Number:Epsilon",fn:(e,t)=>Number.EPSILON},{name:"#Number:MaxValue",fn:(e,t)=>Number.MAX_VALUE},{name:"#Number:MinValue",fn:(e,t)=>Number.MIN_VALUE},{name:"#Number:MinSafeInteger",fn:(e,t)=>Number.MAX_SAFE_INTEGER},{name:"#Number:MinSafeInteger",fn:(e,t)=>Number.MIN_SAFE_INTEGER},{name:"NaN",fn:(e,t)=>Number.NaN}];function ot(e){return e.funcs=(e.funcs||[]).concat(Ye).concat(e.enableCompilationOperators?Qe:[]),e.macros=(e.macros||[]).concat(et).concat(e.enableCompilationOperators?tt:[]),e.symbols=(e.symbols||[]).concat(nt),e}const at=(e,t)=>(...e)=>{Object(P.a)("$bitLShift",e,2,2);let{car:t,cdr:r}=G(...e);return t=Object(E.l)(t),0<=(r=Object(E.l)(r))?r<32?t<<r:0:r>-32?t>>>-r:0},st=(at(),(e,t)=>(...e)=>{Object(P.a)("$bitSRShift",e,2,2);let{car:t,cdr:r}=G(...e);return t=Object(E.l)(t),0<=(r=Object(E.l)(r))?r<32?t>>r:2147483648&t?-1:0:r>-32?t<<-r:0}),ct=(st(),(e,t)=>(...e)=>{Object(P.a)("$bitURShift",e,2,2);let{car:t,cdr:r}=G(...e);return t=Object(E.l)(t),0<=(r=Object(E.l)(r))?r<32?t>>>r:0:r>-32?t<<-r:0}),it=(ct(),(e,t)=>(...e)=>{Object(P.a)("$bitNot",e,1,1);const t=R(...e);return~Object(E.l)(t)}),lt=(it(),(e,t)=>(...e)=>{Object(P.a)("$bitAnd",e,2);const t=R(...e);return e.slice(1).reduce((e,t)=>Object(E.l)(e)&Object(E.l)(t),Object(E.l)(t))}),ft=(lt(),(e,t)=>(...e)=>{Object(P.a)("$bitOr",e,2);const t=R(...e);return e.slice(1).reduce((e,t)=>Object(E.l)(e)|Object(E.l)(t),Object(E.l)(t))}),ut=(ft(),(e,t)=>(...e)=>{Object(P.a)("$bitXor",e,2);const t=R(...e);return e.slice(1).reduce((e,t)=>Object(E.l)(e)^Object(E.l)(t),Object(E.l)(t))}),mt=(ut(),(e,t)=>(...e)=>(Object(P.a)("$add",e,1),e.reduce((e,t)=>Object(E.l)(e)+Object(E.l)(t),0))),bt=(mt(),(e,t)=>(...e)=>{Object(P.a)("$sub",e,1);const t=R(...e);return 0===e.slice(1).length?-Object(E.l)(t):e.slice(1).reduce((e,t)=>Object(E.l)(e)-Object(E.l)(t),Object(E.l)(t))}),$t=(bt(),(e,t)=>(...e)=>{Object(P.a)("$mul",e,2);const t=R(...e);return e.slice(1).reduce((e,t)=>Object(E.l)(e)*Object(E.l)(t),Object(E.l)(t))}),pt=($t(),(e,t)=>(...e)=>{Object(P.a)("$sup",e,2);const t=R(...e);return e.slice(1).reduce((e,t)=>Math.pow(Object(E.l)(e),Object(E.l)(t)),Object(E.l)(t))}),_t=(pt(),(e,t)=>(...e)=>{Object(P.a)("$div",e,2);const t=R(...e);return e.slice(1).reduce((e,t)=>Object(E.l)(e)/Object(E.l)(t),Object(E.l)(t))}),dt=(_t(),(e,t)=>(...e)=>{Object(P.a)("$mod",e,2);const t=R(...e);return e.slice(1).reduce((e,t)=>Object(E.l)(e)%Object(E.l)(t),Object(E.l)(t))}),yt=(dt(),(e,t)=>(...e)=>Math.max(...e.map(e=>Object(E.l)(e)))),gt=(yt(),(e,t)=>(...e)=>Math.min(...e.map(e=>Object(E.l)(e)))),jt=(gt(),(e,t)=>(...e)=>{const t=e.map(e=>Object(E.l)(e));return t.length>0?t.reduce((e,t)=>e+t,0)/t.length:NaN}),Ot=(jt(),(e,t)=>(...e)=>(Object(P.a)("$floor",e,1,1),Math.floor(Object(E.l)(R(...e))))),ht=(Ot(),(e,t)=>(...e)=>(Object(P.a)("$ceil",e,1,1),Math.ceil(Object(E.l)(R(...e))))),vt=(ht(),(e,t)=>(...e)=>(Object(P.a)("$round",e,1,1),Math.round(Object(E.l)(R(...e))))),wt=(vt(),(e,t)=>(...e)=>(Object(P.a)("$abs",e,1,1),Math.abs(Object(E.l)(R(...e))))),St=(wt(),(e,t)=>(...e)=>(Object(P.a)("$sign",e,1,1),Math.sign(Object(E.l)(R(...e)))));St();var At=[{name:"<<",fn:at},{name:"$bit-l-shift",fn:at},{name:">>",fn:st},{name:"$bit-sr-shift",fn:st},{name:">>>",fn:ct},{name:"$bit-ur-shift",fn:ct},{name:"$bit-not",fn:it},{name:"$bit-and",fn:lt},{name:"$bit-or",fn:ft},{name:"$bit-xor",fn:ut},{name:"+",fn:mt},{name:"$add",fn:mt},{name:"$sum",fn:mt},{name:"-",fn:bt},{name:"$sub",fn:bt},{name:"$neg",fn:bt},{name:"*",fn:$t},{name:"$mul",fn:$t},{name:"**",fn:pt},{name:"$sup",fn:pt},{name:"/",fn:_t},{name:"$div",fn:_t},{name:"%",fn:dt},{name:"$mod",fn:dt},{name:"$max",fn:yt},{name:"$min",fn:gt},{name:"$avg",fn:jt},{name:"$floor",fn:Ot},{name:"$ceil",fn:ht},{name:"$round",fn:vt},{name:"$abs",fn:wt},{name:"$sign",fn:St}];var Et=[{name:"$incl",fn:(e,t)=>e=>(Object(P.a)("$incl",e,2,2),[{symbol:"$set"},e[1],[{symbol:"$add"},e[1],1]])},{name:"++",fn:(e,t)=>e=>(Object(P.a)("++",e,2,2),[{symbol:"$set"},e[1],[{symbol:"$add"},e[1],1]])},{name:"$decl",fn:(e,t)=>e=>(Object(P.a)("$decl",e,2,2),[{symbol:"$set"},e[1],[{symbol:"$add"},e[1],-1]])},{name:"--",fn:(e,t)=>e=>(Object(P.a)("--",e,2,2),[{symbol:"$set"},e[1],[{symbol:"$add"},e[1],-1]])},{name:"$incln",fn:(e,t)=>e=>{if(Object(P.a)("$incln",e,3,3),"number"!=typeof e[2])throw new Error("[SX] $incln: Invalid parameter: arg(1) is not number.");return[{symbol:"$set"},e[1],[{symbol:"$add"},e[1],e[2]]]}},{name:"+=",fn:(e,t)=>e=>{if(Object(P.a)("+=",e,3,3),"number"!=typeof e[2])throw new Error("[SX] +=: Invalid parameter: arg(1) is not number.");return[{symbol:"$set"},e[1],[{symbol:"$add"},e[1],e[2]]]}},{name:"$decln",fn:(e,t)=>e=>{if(Object(P.a)("$decln",e,3,3),"number"!=typeof e[2])throw new Error("[SX] $decln: Invalid parameter: arg(1) is not number.");return[{symbol:"$set"},e[1],[{symbol:"$add"},e[1],-e[2]]]}},{name:"-=",fn:(e,t)=>e=>{if(Object(P.a)("-=",e,3,3),"number"!=typeof e[2])throw new Error("[SX] -=: Invalid parameter: arg(1) is not number.");return[{symbol:"$set"},e[1],[{symbol:"$add"},e[1],-e[2]]]}}];var Nt=[];function It(e){return e.funcs=(e.funcs||[]).concat(At),e.macros=(e.macros||[]).concat(Et),e.symbols=(e.symbols||[]).concat(Nt),e}class kt{constructor(e){this.data=e}orderBy(e){let t;return t=Array.isArray(e)?(t,r)=>{for(const n of e)if("string"==typeof n){if(t[n]>r[n])return 1;if(t[n]<r[n])return-1}else{const e="desc"===n[1]?-1:1;if(t[n[0]]>r[n[0]])return 1*e;if(t[n[0]]<r[n[0]])return-1*e}return 0}:e,new kt(this.data.slice(0).sort(t))}groupBy(e){let t;t=Array.isArray(e)?(t,r)=>{for(const n of e)if(t[n]!==r[n])return!1;return!0}:e;const r=[];let n=0,o=1;for(;o<this.data.length;o++)t(this.data[n],this.data[o],o,this.data)||(r.push(this.data.slice(n,o)),n=o);return r.push(this.data.slice(n,o)),new kt(r)}groupEvery(e){if("number"==typeof e)return this.groupBy((t,r,n,o)=>n%e!=0);{const t=Object.assign({first:e.intermediate,last:e.intermediate},e),r=this.groupBy((e,r,n,o)=>t.single>=o.length?n%t.single!=0:n<=t.first?n%t.first!=0:(n-t.first)%t.intermediate!=0);return 1===r.data.length?t.single<r.data[0].length&&r.data.push([]):t.first<r.data[0].length&&r.data.unshift([]),r.data.length>1&&r.data[r.data.length-1].length>t.last&&r.data.push([]),r}}where(e){return new kt(this.data.filter(e))}select(e){return e?this.data.map(e):this.data}}function Tt(e){return new kt(e)}const Xt=(e,t)=>(...e)=>{Object(P.a)("$length",e,1,1);const t=R(...e);switch(typeof t){case"object":if(!("length"in t))break;case"string":return t.length}throw new Error("[SX] $length: Invalid argument type: object has no property 'length'.")},xt=(Xt(),(e,t)=>(...e)=>{Object(P.a)("$trim",e,1,1);const t=R(...e);if("string"==typeof t)return t.trim();throw new Error("[SX] $trim: Invalid argument type: args[0] is not string.")}),Ct=(xt(),(e,t)=>(...e)=>{Object(P.a)("$trimHead",e,1,1);const t=R(...e);if("string"==typeof t)return t.trimLeft();throw new Error("[SX] $trimHead: Invalid argument type: args[0] is not string.")}),Mt=(Ct(),(e,t)=>(...e)=>{Object(P.a)("$trimTail",e,1,1);const t=R(...e);if("string"==typeof t)return t.trimRight();throw new Error("[SX] $trimTail: Invalid argument type: args[0] is not string.")}),Pt=(Mt(),(e,t)=>(...e)=>{if(Object(P.a)("$replaceAll",e,3,3),"string"==typeof e[0]&&"string"==typeof e[1]&&"string"==typeof e[2])return e[0].split(e[1]).join(e[2]);throw new Error("[SX] $replaceAll: Invalid argument type: args[0] or [1] or [2] is not string.")}),Dt=(Pt(),(e,t)=>(...e)=>{if(Object(P.a)("$split",e,2,2),"string"==typeof e[0]&&"string"==typeof e[1])return e[0].split(e[1]);throw new Error("[SX] $split: Invalid argument type: args[0] or [1] is not string.")}),Lt=(Dt(),(e,t)=>(...e)=>{if(Object(P.a)("$join",e,1,2),Array.isArray(e[0]),e.length>1){if("string"==typeof e[1])return e[0].join(e[1]);throw new Error("[SX] $join: Invalid argument type: args[1] is not string.")}return e[0].join()}),qt=(Lt(),(e,t)=>(...e)=>{Object(P.a)("$concat",e,1);const t=R(...e);switch(typeof t){case"object":if(!("concat"in t))break;case"string":return t.concat(...e.slice(1))}throw new Error("[SX] $concat: Invalid argument type: object has no property 'concat'.")}),Ut=(qt(),(e,t)=>(...e)=>{if(Object(P.a)("$slice",e,2,3),3===e.length&&("string"==typeof e[2]||Array.isArray(e[2])))return e[2].slice(Object(E.l)(e[0]),Object(E.l)(e[1]));if(2===e.length&&("string"==typeof e[1]||Array.isArray(e[1])))return e[1].slice(Object(E.l)(e[0]));throw new Error(`[SX] $slice: Invalid argument type: args[${e.length-1}] is not string or array.`)}),Rt=(Ut(),(e,t)=>(...e)=>{if(Object(P.a)("$top",e,2,2),"string"==typeof e[1]||Array.isArray(e[1]))return e[1].slice(0,Object(E.l)(e[0]));throw new Error("[SX] $top: Invalid argument type: args[1] is not string or array.")}),Ft=(Rt(),(e,t)=>(...e)=>{if(Object(P.a)("$tail",e,2,2),"string"==typeof e[1]||Array.isArray(e[1])){const t=-Object(E.l)(e[0]);return e[1].slice(t>=0||Number.isNaN(t)?e[1].length:t)}throw new Error("[SX] $tail: Invalid argument type: args[1] is not string or array.")}),Bt=(Ft(),(e,t)=>(...e)=>(Object(P.a)("$push",e,2,2),Array.isArray(e[0]),e[0].push(e[1]),e[0])),Wt=(Bt(),(e,t)=>(...e)=>{Object(P.a)("$pop",e,1,1),Array.isArray(e[0]);return e[0].pop()}),Kt=(Wt(),(e,t)=>(...e)=>{Object(P.a)("$__at",e,2,2);const{car:t,cdr:r}=G(...e);return r[t]}),Vt=(Kt(),(e,t)=>(...e)=>{Object(P.a)("$reverse",e,1,1);const t=R(...e);if(Array.isArray(t))return t.slice(0).reverse();throw new Error("[SX] $reverse: Invalid argument type: args[0] is not array.")}),Gt=(Vt(),(e,t)=>(...e)=>{Object(P.a)("$reverse!",e,1,1);const t=R(...e);if(Array.isArray(t))return t.reverse();throw new Error("[SX] $reverse!: Invalid argument type: args[0] is not array.")}),Jt=(Gt(),(e,t)=>(...e)=>{Object(P.a)("$find",e,2,2);const{car:t,cdr:r}=G(...e);if(Array.isArray(t))return t.find(r);throw new Error("[SX] $find: Invalid argument type: args[0] is not array.")}),Ht=(Jt(),(e,t)=>(...e)=>{Object(P.a)("$filter",e,2,2);const{car:t,cdr:r}=G(...e);if(Array.isArray(t))return t.filter(r);throw new Error("[SX] $filter: Invalid argument type: args[0] is not array.")}),zt=(Ht(),(e,t)=>(...e)=>{Object(P.a)("$map",e,2,2);const{car:t,cdr:r}=G(...e);if(Array.isArray(t))return t.map(r);throw new Error("[SX] $map: Invalid argument type: args[0] is not array.")}),Yt=(zt(),(e,t)=>(...e)=>{Object(P.a)("$reduce",e,2,3);const{car:t,cdr:r}=G(...e);if(Array.isArray(t))return e.length<3?t.reduce(r):t.reduce(r,e[2]);throw new Error("[SX] $reduce: Invalid argument type: args[0] is not array.")}),Qt=(Yt(),(e,t)=>(...e)=>{Object(P.a)("$reduceFromTail",e,2,3);const{car:t,cdr:r}=G(...e);if(Array.isArray(t))return e.length<3?t.reduceRight(r):t.reduceRight(r,e[2]);throw new Error("[SX] $reduceFromTail: Invalid argument type: args[0] is not array.")}),Zt=(Qt(),(e,t)=>(...e)=>{Object(P.a)("$sort",e,2,2);const{car:t,cdr:r}=G(...e);if(Array.isArray(t))return t.slice(0).sort(r);throw new Error("[SX] $sort: Invalid argument type: args[0] is not array.")}),er=(Zt(),(e,t)=>(...e)=>{Object(P.a)("$sort!",e,2,2);const{car:t,cdr:r}=G(...e);if(Array.isArray(t))return t.sort(r);throw new Error("[SX] $sort!: Invalid argument type: args[0] is not array.")}),tr=(er(),(e,t)=>(...e)=>{Object(P.a)("$group-every",e,2,2);const{car:t,cdr:r}=G(...e);if(!Array.isArray(r))throw new Error("[SX] $group-every: Invalid argument type: args[1] is not array.");return Tt(r).groupEvery(t).select()}),rr=(tr(),(e,t)=>(...e)=>{Object(P.a)("$group-by",e,2,2);const{car:t,cdr:r}=G(...e);if(!Array.isArray(r))throw new Error("[SX] $group-by: Invalid argument type: args[1] is not array.");return Tt(r).groupBy(t).select()}),nr=(rr(),(e,t)=>(...e)=>{Object(P.a)("$order-by",e,2,2);const{car:t,cdr:r}=G(...e);if(!Array.isArray(r))throw new Error("[SX] $order-by: Invalid argument type: args[1] is not array.");return Tt(r).orderBy(t).select()}),or=(nr(),(e,t)=>(...e)=>{Object(P.a)("$where",e,2,2);const{car:t,cdr:r}=G(...e);if("function"!=typeof e[0])throw new Error("[SX] $where: Invalid argument type: args[0] is not function.");if(!Array.isArray(r))throw new Error("[SX] $where: Invalid argument type: args[1] is not array.");return Tt(r).where(t).select()});or();var ar=[{name:"$range",fn:(e,t)=>(...t)=>{Object(P.a)("$range",t,2,3);const{car:r,cdr:n}=G(...t),o=Object(E.l)(r)||0,a=Object(E.l)(n)||0,s=t.length>2&&Object(E.l)(t[2])||(o<=a?1:-1),c=Math.sign(a-o)+Math.sign(s)!==0?Math.floor(Math.abs(a-o)/Math.abs(s))+1:0;return e.evalCount+=c,Object(E.b)(e,0),Array.from({length:c},(e,t)=>o+t*s)}},{name:"$length",fn:Xt},{name:"$trim",fn:xt},{name:"$trim-head",fn:Ct},{name:"$trim-tail",fn:Mt},{name:"$replace-all",fn:Pt},{name:"$split",fn:Dt},{name:"$join",fn:Lt},{name:"$concat",fn:qt},{name:"$slice",fn:Ut},{name:"$top",fn:Rt},{name:"$tail",fn:Ft},{name:"$push",fn:Bt},{name:"$pop",fn:Wt},{name:"$__at",fn:Kt},{name:"$reverse",fn:Vt},{name:"$reverse!",fn:Gt},{name:"$find",fn:Jt},{name:"$filter",fn:Ht},{name:"$map",fn:zt},{name:"$reduce",fn:Yt},{name:"$reduce-from-head",fn:Yt},{name:"$reduce-from-tail",fn:Qt},{name:"$sort",fn:Zt},{name:"$sort!",fn:er},{name:"$group-every",fn:tr},{name:"$group-by",fn:rr},{name:"$order-by",fn:nr},{name:"$where",fn:or}];var sr=[{name:"$[",fn:(e,t)=>e=>{if(!Object(o.d)(e[2],"]"))throw new Error("[SX] $repeat: Invalid syntax: missing ']' keyword.");return[{symbol:"$__at"},e[1],e[3]]}}];var cr=[];function ir(e){return e.funcs=(e.funcs||[]).concat(ar),e.macros=(e.macros||[]).concat(sr),e.symbols=(e.symbols||[]).concat(cr),e}const lr=(e,t)=>(...t)=>{Object(P.a)("$__letAsync",t,2,2);let r=t[1];return"object"==typeof r&&"function"==typeof r.then||(r=Promise.resolve(r)),r=r.then(r=>{try{return oe(e)(t[0],r),r}catch(e){return Promise.reject(e)}})},fr=(lr(null),(e,t)=>(...t)=>{Object(P.a)("$__setAsync",t,2,2);let r=t[1];return"object"==typeof r&&"function"==typeof r.then||(r=Promise.resolve(r)),r=r.then(r=>{try{return ae(e)(t[0],r),r}catch(e){return Promise.reject(e)}})}),ur=(fr(null),(e,t)=>(...e)=>{Object(P.a)("$then",e,2,3);let t=e[0];if("object"==typeof t&&"function"==typeof t.then||(t=Promise.resolve(t)),"function"==typeof e[2])t=t.then(e[1],e[2]);else{if("function"!=typeof e[1])throw new Error("[SX] $then: Invalid argument(s): args[1] is not function.");t=t.then(e[1])}return t}),mr=(ur(),(e,t)=>(...e)=>{const t=e.slice(0);for(let e=0;e<t.length;e++)"object"==typeof t[e]&&"function"==typeof t[e].then||(t[e]=Promise.resolve(t[e]));return Promise.all(t)}),br=(mr(),(e,t)=>(...e)=>{const t=e.slice(0);for(let e=0;e<t.length;e++)"object"==typeof t[e]&&"function"==typeof t[e].then||(t[e]=Promise.resolve(t[e]));const r=e=>new Promise((t,r)=>e.then(r,t));return(e=>r(Promise.all(e.map(r))))(t)}),$r=(br(),(e,t)=>(...e)=>{Object(P.a)("$resolvePipe",e,1);let t=e[0];"object"==typeof t&&"function"==typeof t.then||(t=Promise.resolve(t));const r=e.slice(1);for(let e=0;e<r.length;e++)if("function"!=typeof r[e]){const t=r[e];r[e]=()=>t}let n=t;for(const e of r)n=n.then(e);return n}),pr=($r(),(e,t)=>(...e)=>{Object(P.a)("$resolveFork",e,1);let t=e[0];"object"==typeof t&&"function"==typeof t.then||(t=Promise.resolve(t));const r=e.slice(1);for(let e=0;e<r.length;e++)if("function"!=typeof r[e]){const t=r[e];r[e]=()=>t}const n=new Array(r.length),o=new Array(r.length),a=[];for(let e=0;e<r.length;e++)a.push(new Promise((t,a)=>{n[e]=n=>{let o=r[e](n);"object"==typeof o&&"function"==typeof o.then||(o=Promise.resolve(o)),o.then(e=>t(e)).catch(e=>a(e))},o[e]=a}));return t.then(e=>n.forEach(t=>t(e)),e=>o.forEach(t=>t(e))),a});pr();var _r=[{name:"$__let-async",fn:lr},{name:"$__set-async",fn:fr},{name:"$then",fn:ur},{name:"$resolve-all",fn:mr},{name:"$resolve-any",fn:br},{name:"$resolve-pipe",fn:$r},{name:"$resolve-fork",fn:pr}];var dr=[{name:"$let-async",fn:(e,t)=>t=>(Object(P.a)("$let-async",t,3,3),[{symbol:"$__let-async"},Object(o.f)(e,t[1]),t[2]])},{name:"$set-async",fn:(e,t)=>t=>(Object(P.a)("$set-async",t,3,3),[{symbol:"$__set-async"},Object(o.f)(e,t[1]),t[2]])}];var yr=[];function gr(e){return e.funcs=(e.funcs||[]).concat(_r),e.macros=(e.macros||[]).concat(dr),e.symbols=(e.symbols||[]).concat(yr),e}const jr=(()=>{let e=Object.assign({},s);return e.reservedNames=Object.assign({},e.reservedNames,{Template:"$concat"}),(e=gr(e=ir(e=It(e=ot(e))))).stripComments=!0,T(e)})(),Or=jr,hr=jr,vr=(()=>{let e=Object.assign({},s);return e.reservedNames=Object.assign({},e.reservedNames,{Template:"$concat"}),(e=gr(e=ir(e=It(e=ot(e))))).stripComments=!0,X(e)})(),wr=vr,Sr=vr,Ar=(()=>{let e=Object.assign({},s);return e.reservedNames=Object.assign({},e.reservedNames,{Template:"$concat"}),(e=gr(e=ir(e=It(e=ot(e))))).stripComments=!0,e.returnMultipleRoot=!0,T(e)})(),Er=(()=>{let e=Object.assign({},s);return e.reservedNames=Object.assign({},e.reservedNames,{Template:"$concat"}),(e=gr(e=ir(e=It(e=ot(e))))).stripComments=!0,e.returnMultipleRoot=!0,X(e)})(),Nr=(e,t)=>(...t)=>{const r={};for(const n of t){if(!(Array.isArray(n)&&0<n.length))throw new Error("[SX] $jsxProps: Invalid argument(s): args[?] is not array.");{const t=Object(o.d)(n[0]),a=t?t.symbol:String(Object(E.b)(e,n[0]));switch(a){case"style":if(1===n.length)r[a]="";else if(n.length>=2){const t={};for(const r of n.slice(1))if(Array.isArray(r)&&1<r.length){const n=String(Object(E.b)(e,r[0]));Object(P.c)("$jsxProps",t,n),t[n]=String(Object(E.b)(e,r[1]))}else if("string"==typeof r)for(const e of r.split(";")){const r=/^\s*(\S+)\s*:\s*(.*?)\s*$/.exec(e);r&&(Object(P.c)("$jsxProps",t,r[1]),t[r[1]]=r[2])}r[a]=t}break;case"class":case"styleClass":if(1===n.length)r[a]=[];else if(n.length>=2){let t=[];for(const r of n.slice(1))Array.isArray(r)?t=t.concat(r.map(t=>Object(E.b)(e,t))):"string"==typeof r&&(t=t.concat(r.split(" ")));const o=[],s=e=>e.forEach(e=>null==e?void 0:Array.isArray(e)?s(e):o.push(String(e)));s(t),r[a]=o}break;case"className":if(1===n.length)r[a]="";else if(n.length>=2){let t="";for(const r of n.slice(1)){let n="";if(Array.isArray(r)){const t=[],o=r=>r.map(t=>Object(E.b)(e,t)).forEach(e=>null==e?void 0:Array.isArray(e)?o(e):t.push(String(e)));o(r),n=t.join(" ")}else"string"==typeof r&&(n=r);0<t.length?t+=" "+n:t=n}r[a]=t}break;case"dangerouslySetInnerHTML":1===n.length?r[a]={__html:""}:n.length>=2?r[a]={__html:Object(E.b)(e,n[1])}:r[a]={__html:Object(E.b)(e,[{symbol:e.config.reservedNames.list}].concat(n.slice(1)))};break;case"setInnerText":1===n.length?r[a]={__text:""}:n.length>=2?r[a]={__text:Object(E.b)(e,n[1])}:r[a]={__text:Object(E.b)(e,[{symbol:e.config.reservedNames.list}].concat(n.slice(1)))};break;default:Object(P.c)("$jsxProps",r,a),1===n.length?r[a]=!0:2===n.length?r[a]=Object(E.b)(e,n[1]):r[a]=Object(E.b)(e,[{symbol:e.config.reservedNames.list}].concat(n.slice(1)))}}}return r};function Ir(e,...t){let r=t,n={};if(0<t.length&&Array.isArray(t[0])){Object(o.d)(t[0][0],"@")&&(n=Nr(e,"")(...t[0].slice(1)),r=r.slice(1))}return{props:n,children:r}}const kr=(e,t)=>(...r)=>{const{props:n,children:o}=Ir(e,...r);return e.config.jsx(t,n,...o)},Tr=e=>(t,r)=>(...r)=>{const{props:n,children:o}=Ir(t,...r);return t.config.jsx(e,n,...o)};var Xr=[{name:"$=__if",fn:(e,t)=>(...t)=>{Object(P.a)("$__outputIf",t,2);const{car:r,cdr:n}=G(...t);let o=[];return ce(r)&&(2<t.length?(o.push({symbol:e.config.reservedNames.Template},...t.slice(1)),o=Object(E.b)(e,o)):o=Object(E.b)(e,n)),o}},{name:"$=__for",fn:(e,t)=>(...t)=>{Object(P.a)("$__outputForOf",t,2);const r=R(...t),n=[];if(!Array.isArray(r))throw new Error("[SX] $__outputForOf: Invalid argument(s): args[0] is not array.");for(let a=0;a<r.length;a++){const s=r[a],c=Q(e)(!0,!0,[["$data",Object(o.f)(e,s)],["$index",a],["$array",Object(o.f)(e,r)],["$parent",Object(o.f)(e,Object(E.e)(e).scope)]],...t.slice(1));2<t.length&&Array.isArray(c)?n.push(...c):n.push(c)}return Object(E.b)(e,[{symbol:e.config.reservedNames.Template}].concat(n.map(t=>[{symbol:e.config.reservedNames.quote},t])))}}];var xr=[{name:"@",fn:(e,t)=>t=>Object(o.f)(e,t)},{name:"$=if",fn:(e,t)=>t=>[{symbol:"$=__if"},t[1],...t.slice(2).map(t=>Object(o.f)(e,t))]},{name:"$=for",fn:(e,t)=>t=>[{symbol:"$=__for"},t[1],...t.slice(2).map(t=>Object(o.f)(e,t))]}];var Cr=[];function Mr(e,t){e.funcs=(e.funcs||[]).concat(Xr),e.macros=(e.macros||[]).concat(xr),e.symbols=(e.symbols||[]).concat(Cr);const r=Object.entries(t.components).map(e=>({name:e[0],fn:Tr(e[1])}));return e.funcs=e.funcs.concat({name:e.reservedNames.Template,fn:Tr(t.jsxFlagment)},...r),e.funcSymbolResolverFallback=kr,e.jsx=t.jsx,e.JsxFragment=t.jsxFlagment,e}function Pr(e){let t=Object.assign({},s);return(t=Mr(t=gr(t=ir(t=It(t=ot(t)))),e)).stripComments=!0,T(t)}function Dr(e){let t=Object.assign({},s);return(t=Mr(t=gr(t=ir(t=It(t=ot(t)))),e)).stripComments=!0,X(t)}function Lr(e,t,r="text/lisp"){const n=document.querySelectorAll(`script[type="${r}"]`),o=[];for(let e=0;e<n.length;e++)o.push(n[e].innerHTML);return(e=e.appendGlobals(t||{}))(o.join("\n"))}r.d(t,"builtinOperators",(function(){return qr})),r.d(t,"builtinMacros",(function(){return Ur})),r.d(t,"builtinSymbols",(function(){return Rr})),r.d(t,"FatalError",(function(){return n.a})),r.d(t,"MaxEvaluationCountError",(function(){return n.b})),r.d(t,"ScriptTerminationError",(function(){return n.c})),r.d(t,"quote",(function(){return o.f})),r.d(t,"isQuoted",(function(){return o.c})),r.d(t,"backquote",(function(){return o.a})),r.d(t,"isBackquoted",(function(){return o.b})),r.d(t,"wrapByUnquote",(function(){return o.i})),r.d(t,"isUnquoted",(function(){return o.e})),r.d(t,"spread",(function(){return o.h})),r.d(t,"splice",(function(){return o.g})),r.d(t,"isSymbol",(function(){return o.d})),r.d(t,"defaultReservedNames",(function(){return a})),r.d(t,"defaultConfig",(function(){return s})),r.d(t,"SExpression",(function(){return T})),r.d(t,"SExpressionAsync",(function(){return X})),r.d(t,"S",(function(){return x})),r.d(t,"L",(function(){return jr})),r.d(t,"LS",(function(){return Or})),r.d(t,"lisp",(function(){return hr})),r.d(t,"L_async",(function(){return vr})),r.d(t,"LS_async",(function(){return wr})),r.d(t,"lisp_async",(function(){return Sr})),r.d(t,"LM",(function(){return Ar})),r.d(t,"LM_async",(function(){return Er})),r.d(t,"LSX",(function(){return Pr})),r.d(t,"LSX_async",(function(){return Dr})),r.d(t,"runScriptTags",(function(){return Lr})),r.d(t,"installCore",(function(){return ot})),r.d(t,"installArithmetic",(function(){return It})),r.d(t,"installSequence",(function(){return ir})),r.d(t,"installJsx",(function(){return Mr})),r.d(t,"installConcurrent",(function(){return gr}));const qr={core:Ze,arithmetic:At,sequence:ar,jsx:Xr,concurrent:_r},Ur={core:rt,arithmetic:Et,sequence:sr,jsx:xr,concurrent:dr},Rr={core:nt,arithmetic:Nt,sequence:cr,jsx:Cr,concurrent:yr}}])}));
//# sourceMappingURL=liyad.min.js.map